(function(_0x23c386,_0x26b266){const _0x4ea4bc=a1_0x3808,_0x197a42=_0x23c386();while(!![]){try{const _0x3974ab=parseInt(_0x4ea4bc(0x12d))/0x1*(parseInt(_0x4ea4bc(0x104))/0x2)+-parseInt(_0x4ea4bc(0x134))/0x3*(-parseInt(_0x4ea4bc(0xff))/0x4)+parseInt(_0x4ea4bc(0x13f))/0x5+-parseInt(_0x4ea4bc(0x111))/0x6+parseInt(_0x4ea4bc(0x13b))/0x7+-parseInt(_0x4ea4bc(0x10d))/0x8+-parseInt(_0x4ea4bc(0x13d))/0x9*(parseInt(_0x4ea4bc(0x143))/0xa);if(_0x3974ab===_0x26b266)break;else _0x197a42['push'](_0x197a42['shift']());}catch(_0x216066){_0x197a42['push'](_0x197a42['shift']());}}}(a1_0x175c,0x8797b));const a1_0x3a5f25=(function(){let _0x509825=!![];return function(_0x1193c0,_0x54a38a){const _0x2bccc3=_0x509825?function(){const _0x40945f=a1_0x3808;if(_0x54a38a){const _0x1662bf=_0x54a38a[_0x40945f(0x135)](_0x1193c0,arguments);return _0x54a38a=null,_0x1662bf;}}:function(){};return _0x509825=![],_0x2bccc3;};}()),a1_0x35f872=a1_0x3a5f25(this,function(){const _0x31b5ed=a1_0x3808;return a1_0x35f872[_0x31b5ed(0x130)]()[_0x31b5ed(0x106)](_0x31b5ed(0x132))[_0x31b5ed(0x130)]()[_0x31b5ed(0x10a)](a1_0x35f872)[_0x31b5ed(0x106)](_0x31b5ed(0x132));});a1_0x35f872();import{ipcMain}from'electron';import{initDb}from'./index.js';import*as a1_0x222ced from'./schema.js';function a1_0x175c(){const _0x116796=['returning','patientName','insert','db:deleteDoctor','utf8','db:deleteCase','status','settings','columns','db:getDoctor','ageDays','writeFileSync','join','2VutjyU','handle','interpretation','toString','patientId','(((.+)+)+)+$','designation','3336bRRKjJ','apply','db:createPatient','.sqlite_migrated','testsMaster','db:createCase','existsSync','2927246dhzNDy','onConflictDoUpdate','21447hRUtxv','parse','1237135DZmrvM','gender','Migration\x20from\x20db.json\x20to\x20SQLite\x20completed\x20successfully.','db.json','2610EFIuTw','db:getTest','ageYears','collectionDate','db:getCase','db:getPatient','doctors','onConflictDoNothing','update','log','value','Migration\x20failed:','referral','db:updateCase','sampleType','entries','patients','address','cases','2936YLtLgB','date','db:deletePatient','set','error','779322hGCsXM','tests','search','length','db:updatePatient','department','constructor','where','db:getTests','8598552VQxaoB','db:deleteTest','db:createDoctor','key','53796DXzmNh','price','values','ageMonths','from','readFileSync','db:getCases','map','email','collectionTime','all','db:createTest','forEach','select','delete'];a1_0x175c=function(){return _0x116796;};return a1_0x175c();}import{eq}from'drizzle-orm';import a1_0xb4448a from'fs';import a1_0x1953d5 from'path';function a1_0x3808(_0x4cc792,_0x897e22){_0x4cc792=_0x4cc792-0xfa;const _0x2dc06f=a1_0x175c();let _0x35f872=_0x2dc06f[_0x4cc792];return _0x35f872;}export function setupHandlers(_0x55d590){const _0x23dcf3=a1_0x3808,_0x183b06=initDb(_0x55d590),_0x1e1f9e=a1_0x1953d5[_0x23dcf3(0x12c)](_0x55d590,_0x23dcf3(0x142)),_0x424508=a1_0x1953d5[_0x23dcf3(0x12c)](_0x55d590,_0x23dcf3(0x137));a1_0xb4448a['existsSync'](_0x1e1f9e)&&!a1_0xb4448a[_0x23dcf3(0x13a)](_0x424508)&&(migrateFromJson(_0x1e1f9e,_0x183b06),a1_0xb4448a[_0x23dcf3(0x12b)](_0x424508,'true')),ipcMain[_0x23dcf3(0x12e)]('db:getPatients',async()=>{const _0x892ee6=_0x23dcf3;return await _0x183b06[_0x892ee6(0x11e)]()[_0x892ee6(0x115)](a1_0x222ced[_0x892ee6(0xfc)]);}),ipcMain['handle'](_0x23dcf3(0x148),async(_0x536b31,_0x1f56b1)=>{const _0x52aa97=_0x23dcf3,_0x492e29=await _0x183b06['select']()[_0x52aa97(0x115)](a1_0x222ced['patients'])['where'](eq(a1_0x222ced['patients']['id'],_0x1f56b1));return _0x492e29[0x0];}),ipcMain[_0x23dcf3(0x12e)](_0x23dcf3(0x136),async(_0x5d8889,_0x6bb4bb)=>{const _0x18a20f=_0x23dcf3,_0x459a30=await _0x183b06[_0x18a20f(0x122)](a1_0x222ced[_0x18a20f(0xfc)])[_0x18a20f(0x113)](_0x6bb4bb)[_0x18a20f(0x120)]();return _0x459a30[0x0];}),ipcMain['handle'](_0x23dcf3(0x108),async(_0x4f8bf5,{id:_0x2a4037,data:_0x326d76})=>{const _0x106efb=_0x23dcf3,_0x318f4e=await _0x183b06[_0x106efb(0x14b)](a1_0x222ced['patients'])[_0x106efb(0x102)](_0x326d76)[_0x106efb(0x10b)](eq(a1_0x222ced['patients']['id'],_0x2a4037))[_0x106efb(0x120)]();return _0x318f4e[0x0];}),ipcMain['handle'](_0x23dcf3(0x101),async(_0x26c54e,_0x3712b3)=>{const _0x3de95b=_0x23dcf3;return await _0x183b06[_0x3de95b(0x11f)](a1_0x222ced[_0x3de95b(0xfc)])[_0x3de95b(0x10b)](eq(a1_0x222ced[_0x3de95b(0xfc)]['id'],_0x3712b3))[_0x3de95b(0x120)]();}),ipcMain[_0x23dcf3(0x12e)](_0x23dcf3(0x117),async()=>{const _0x52f8fc=_0x23dcf3;return await _0x183b06[_0x52f8fc(0x11e)]()[_0x52f8fc(0x115)](a1_0x222ced[_0x52f8fc(0xfe)]);}),ipcMain[_0x23dcf3(0x12e)](_0x23dcf3(0x147),async(_0x1ecf71,_0x317f3c)=>{const _0x16b2d3=_0x23dcf3,_0x3e0401=await _0x183b06['select']()['from'](a1_0x222ced[_0x16b2d3(0xfe)])['where'](eq(a1_0x222ced['cases']['id'],_0x317f3c));return _0x3e0401[0x0];}),ipcMain[_0x23dcf3(0x12e)](_0x23dcf3(0x139),async(_0x397beb,_0x1942ef)=>{const _0x17a86b=_0x23dcf3,_0x443e0c=await _0x183b06['insert'](a1_0x222ced['cases'])[_0x17a86b(0x113)](_0x1942ef)['returning']();return _0x443e0c[0x0];}),ipcMain[_0x23dcf3(0x12e)](_0x23dcf3(0x150),async(_0x142436,{id:_0x3fd81c,data:_0x30d174})=>{const _0x773f7b=_0x23dcf3,_0x1728b2=await _0x183b06[_0x773f7b(0x14b)](a1_0x222ced[_0x773f7b(0xfe)])['set'](_0x30d174)['where'](eq(a1_0x222ced['cases']['id'],_0x3fd81c))['returning']();return _0x1728b2[0x0];}),ipcMain[_0x23dcf3(0x12e)](_0x23dcf3(0x125),async(_0x59dfa3,_0x2bdc57)=>{const _0xf9aaad=_0x23dcf3;return await _0x183b06['delete'](a1_0x222ced[_0xf9aaad(0xfe)])['where'](eq(a1_0x222ced[_0xf9aaad(0xfe)]['id'],_0x2bdc57))[_0xf9aaad(0x120)]();}),ipcMain['handle'](_0x23dcf3(0x10c),async()=>{const _0x943ea5=_0x23dcf3;return await _0x183b06[_0x943ea5(0x11e)]()[_0x943ea5(0x115)](a1_0x222ced[_0x943ea5(0x138)]);}),ipcMain['handle'](_0x23dcf3(0x144),async(_0x424010,_0x3ef172)=>{const _0xf622ad=_0x23dcf3,_0x14fc9b=await _0x183b06['select']()[_0xf622ad(0x115)](a1_0x222ced[_0xf622ad(0x138)])[_0xf622ad(0x10b)](eq(a1_0x222ced[_0xf622ad(0x138)]['id'],_0x3ef172));return _0x14fc9b[0x0];}),ipcMain['handle'](_0x23dcf3(0x11c),async(_0x438fc8,_0x13cbc9)=>{const _0x2f062b=_0x23dcf3,_0x3fa26f=await _0x183b06[_0x2f062b(0x122)](a1_0x222ced[_0x2f062b(0x138)])[_0x2f062b(0x113)](_0x13cbc9)[_0x2f062b(0x120)]();return _0x3fa26f[0x0];}),ipcMain[_0x23dcf3(0x12e)]('db:updateTest',async(_0x5295e4,{id:_0x1279b8,data:_0x214d9c})=>{const _0x4d487d=_0x23dcf3,_0x514949=await _0x183b06[_0x4d487d(0x14b)](a1_0x222ced[_0x4d487d(0x138)])[_0x4d487d(0x102)](_0x214d9c)['where'](eq(a1_0x222ced[_0x4d487d(0x138)]['id'],_0x1279b8))[_0x4d487d(0x120)]();return _0x514949[0x0];}),ipcMain[_0x23dcf3(0x12e)](_0x23dcf3(0x10e),async(_0xd79fde,_0x396b4f)=>{const _0x388836=_0x23dcf3;return await _0x183b06[_0x388836(0x11f)](a1_0x222ced[_0x388836(0x138)])[_0x388836(0x10b)](eq(a1_0x222ced[_0x388836(0x138)]['id'],_0x396b4f))[_0x388836(0x120)]();}),ipcMain[_0x23dcf3(0x12e)]('db:getDoctors',async()=>{const _0x2b7a62=_0x23dcf3;return await _0x183b06['select']()[_0x2b7a62(0x115)](a1_0x222ced['doctors']);}),ipcMain['handle'](_0x23dcf3(0x129),async(_0xf09d9b,_0x25879d)=>{const _0x105037=_0x23dcf3,_0x2993c7=await _0x183b06['select']()['from'](a1_0x222ced['doctors'])[_0x105037(0x10b)](eq(a1_0x222ced['doctors']['id'],_0x25879d));return _0x2993c7[0x0];}),ipcMain['handle'](_0x23dcf3(0x10f),async(_0x4952e7,_0x16b322)=>{const _0x28aed2=_0x23dcf3,_0x1a35cf=await _0x183b06[_0x28aed2(0x122)](a1_0x222ced[_0x28aed2(0x149)])[_0x28aed2(0x113)](_0x16b322)[_0x28aed2(0x120)]();return _0x1a35cf[0x0];}),ipcMain[_0x23dcf3(0x12e)]('db:updateDoctor',async(_0x37d699,{id:_0xd923f8,data:_0x162fc3})=>{const _0x1ee70c=_0x23dcf3,_0x75007d=await _0x183b06[_0x1ee70c(0x14b)](a1_0x222ced[_0x1ee70c(0x149)])[_0x1ee70c(0x102)](_0x162fc3)[_0x1ee70c(0x10b)](eq(a1_0x222ced[_0x1ee70c(0x149)]['id'],_0xd923f8))[_0x1ee70c(0x120)]();return _0x75007d[0x0];}),ipcMain[_0x23dcf3(0x12e)](_0x23dcf3(0x123),async(_0x7ef33,_0x31b916)=>{const _0x49f678=_0x23dcf3;return await _0x183b06[_0x49f678(0x11f)](a1_0x222ced[_0x49f678(0x149)])[_0x49f678(0x10b)](eq(a1_0x222ced[_0x49f678(0x149)]['id'],_0x31b916))['returning']();}),ipcMain[_0x23dcf3(0x12e)]('db:getSettings',async()=>{const _0xaa13cf=_0x23dcf3,_0x7081ec=await _0x183b06[_0xaa13cf(0x11e)]()[_0xaa13cf(0x115)](a1_0x222ced[_0xaa13cf(0x127)]),_0x29c409={};return _0x7081ec[_0xaa13cf(0x11d)](_0x5d0d50=>{const _0xea1924=_0xaa13cf;_0x29c409[_0x5d0d50[_0xea1924(0x110)]]=_0x5d0d50[_0xea1924(0x14d)];}),_0x29c409;}),ipcMain[_0x23dcf3(0x12e)]('db:updateSettings',async(_0x1e8c72,_0x9bddf)=>{const _0x408f98=_0x23dcf3,_0x119463=Object[_0x408f98(0xfb)](_0x9bddf)[_0x408f98(0x118)](([_0x4dba8b,_0x13a62b])=>{const _0x1d7bfc=_0x408f98;return _0x183b06[_0x1d7bfc(0x122)](a1_0x222ced[_0x1d7bfc(0x127)])[_0x1d7bfc(0x113)]({'key':_0x4dba8b,'value':_0x13a62b})[_0x1d7bfc(0x13c)]({'target':a1_0x222ced['settings'][_0x1d7bfc(0x110)],'set':{'value':_0x13a62b}});});return await Promise[_0x408f98(0x11b)](_0x119463),!![];});}async function migrateFromJson(_0x207d18,_0x187f0d){const _0x276a19=a1_0x3808;try{const _0x51311d=a1_0xb4448a[_0x276a19(0x116)](_0x207d18,_0x276a19(0x124)),_0x51031a=JSON[_0x276a19(0x13e)](_0x51311d);if(_0x51031a[_0x276a19(0xfc)]&&_0x51031a[_0x276a19(0xfc)][_0x276a19(0x107)]>0x0){const _0x5b00b2=_0x51031a[_0x276a19(0xfc)][_0x276a19(0x118)](_0x3c0593=>({'id':_0x3c0593['id'],'designation':_0x3c0593[_0x276a19(0x133)],'patientName':_0x3c0593[_0x276a19(0x121)],'ageYears':_0x3c0593[_0x276a19(0x145)],'ageMonths':_0x3c0593[_0x276a19(0x114)],'ageDays':_0x3c0593[_0x276a19(0x12a)],'gender':_0x3c0593[_0x276a19(0x140)],'phone':_0x3c0593['phone'],'email':_0x3c0593[_0x276a19(0x119)],'collectionDate':_0x3c0593['collectionDate'],'address':_0x3c0593[_0x276a19(0xfd)],'referral':_0x3c0593[_0x276a19(0x14f)],'sampleType':_0x3c0593['sampleType'],'collectionTime':_0x3c0593[_0x276a19(0x11a)]}));await _0x187f0d[_0x276a19(0x122)](a1_0x222ced[_0x276a19(0xfc)])[_0x276a19(0x113)](_0x5b00b2)[_0x276a19(0x14a)]();}if(_0x51031a[_0x276a19(0xfe)]&&_0x51031a[_0x276a19(0xfe)][_0x276a19(0x107)]>0x0){const _0x3298c2=_0x51031a[_0x276a19(0xfe)][_0x276a19(0x118)](_0x4087f3=>({'id':_0x4087f3['id'],'patientId':_0x4087f3[_0x276a19(0x131)],'patientName':_0x4087f3[_0x276a19(0x121)],'referral':_0x4087f3['referral'],'sampleType':_0x4087f3[_0x276a19(0xfa)],'collectionDate':_0x4087f3[_0x276a19(0x146)],'collectionTime':_0x4087f3[_0x276a19(0x11a)],'date':_0x4087f3[_0x276a19(0x100)],'status':_0x4087f3[_0x276a19(0x126)],'tests':_0x4087f3[_0x276a19(0x105)]}));await _0x187f0d[_0x276a19(0x122)](a1_0x222ced['cases'])['values'](_0x3298c2)[_0x276a19(0x14a)]();}if(_0x51031a['tests']&&_0x51031a[_0x276a19(0x105)]['length']>0x0){const _0x584907=_0x51031a[_0x276a19(0x105)][_0x276a19(0x118)](_0x12355d=>({'id':_0x12355d['id'],'testName':_0x12355d['testName'],'price':_0x12355d[_0x276a19(0x112)],'department':_0x12355d[_0x276a19(0x109)],'parameters':_0x12355d['parameters'],'columns':_0x12355d[_0x276a19(0x128)],'interpretation':_0x12355d[_0x276a19(0x12f)]}));await _0x187f0d[_0x276a19(0x122)](a1_0x222ced[_0x276a19(0x138)])[_0x276a19(0x113)](_0x584907)[_0x276a19(0x14a)]();}if(_0x51031a[_0x276a19(0x127)]){const _0x17be90=Object[_0x276a19(0xfb)](_0x51031a[_0x276a19(0x127)])['map'](([_0x209b91,_0x2b0fbe])=>{const _0x274446=_0x276a19;return _0x187f0d['insert'](a1_0x222ced[_0x274446(0x127)])[_0x274446(0x113)]({'key':_0x209b91,'value':_0x2b0fbe})[_0x274446(0x14a)]();});await Promise['all'](_0x17be90);}console[_0x276a19(0x14c)](_0x276a19(0x141));}catch(_0x15de1b){console[_0x276a19(0x103)](_0x276a19(0x14e),_0x15de1b);}}