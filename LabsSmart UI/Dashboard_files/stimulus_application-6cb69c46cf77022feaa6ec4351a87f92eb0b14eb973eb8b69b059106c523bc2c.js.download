(()=>{var kn=Object.defineProperty;var o=(e,t)=>{for(var r in t)kn(e,r,{get:t[r],enumerable:!0})};var dn=function(){function e(t,r){this.eventTarget=t,this.eventName=r,this.unorderedBindings=new Set}return e.prototype.connect=function(){this.eventTarget.addEventListener(this.eventName,this,!1)},e.prototype.disconnect=function(){this.eventTarget.removeEventListener(this.eventName,this,!1)},e.prototype.bindingConnected=function(t){this.unorderedBindings.add(t)},e.prototype.bindingDisconnected=function(t){this.unorderedBindings.delete(t)},e.prototype.handleEvent=function(t){for(var r=Pn(t),n=0,s=this.bindings;n<s.length;n++){var a=s[n];if(r.immediatePropagationStopped)break;a.handleEvent(r)}},Object.defineProperty(e.prototype,"bindings",{get:function(){return Array.from(this.unorderedBindings).sort(function(t,r){var n=t.index,s=r.index;return n<s?-1:n>s?1:0})},enumerable:!0,configurable:!0}),e}();function Pn(e){if("immediatePropagationStopped"in e)return e;var t=e.stopImmediatePropagation;return Object.assign(e,{immediatePropagationStopped:!1,stopImmediatePropagation:function(){this.immediatePropagationStopped=!0,t.call(this)}})}var cn=function(){function e(t){this.application=t,this.eventListenerMaps=new Map,this.started=!1}return e.prototype.start=function(){this.started||(this.started=!0,this.eventListeners.forEach(function(t){return t.connect()}))},e.prototype.stop=function(){this.started&&(this.started=!1,this.eventListeners.forEach(function(t){return t.disconnect()}))},Object.defineProperty(e.prototype,"eventListeners",{get:function(){return Array.from(this.eventListenerMaps.values()).reduce(function(t,r){return t.concat(Array.from(r.values()))},[])},enumerable:!0,configurable:!0}),e.prototype.bindingConnected=function(t){this.fetchEventListenerForBinding(t).bindingConnected(t)},e.prototype.bindingDisconnected=function(t){this.fetchEventListenerForBinding(t).bindingDisconnected(t)},e.prototype.handleError=function(t,r,n){n===void 0&&(n={}),this.application.handleError(t,"Error "+r,n)},e.prototype.fetchEventListenerForBinding=function(t){var r=t.eventTarget,n=t.eventName;return this.fetchEventListener(r,n)},e.prototype.fetchEventListener=function(t,r){var n=this.fetchEventListenerMapForEventTarget(t),s=n.get(r);return s||(s=this.createEventListener(t,r),n.set(r,s)),s},e.prototype.createEventListener=function(t,r){var n=new dn(t,r);return this.started&&n.connect(),n},e.prototype.fetchEventListenerMapForEventTarget=function(t){var r=this.eventListenerMaps.get(t);return r||(r=new Map,this.eventListenerMaps.set(t,r)),r},e}();var jn=/^((.+?)(@(window|document))?->)?(.+?)(#(.+))?$/;function un(e){var t=e.trim(),r=t.match(jn)||[];return{eventTarget:Nn(r[4]),eventName:r[2],identifier:r[5],methodName:r[7]}}function Nn(e){if(e=="window")return window;if(e=="document")return document}function hn(e){if(e==window)return"window";if(e==document)return"document"}var pn=function(){function e(t,r,n){this.element=t,this.index=r,this.eventTarget=n.eventTarget||t,this.eventName=n.eventName||Dn(t)||x("missing event name"),this.identifier=n.identifier||x("missing identifier"),this.methodName=n.methodName||x("missing method name")}return e.forToken=function(t){return new this(t.element,t.index,un(t.content))},e.prototype.toString=function(){var t=this.eventTargetName?"@"+this.eventTargetName:"";return""+this.eventName+t+"->"+this.identifier+"#"+this.methodName},Object.defineProperty(e.prototype,"eventTargetName",{get:function(){return hn(this.eventTarget)},enumerable:!0,configurable:!0}),e}();var mn={a:function(e){return"click"},button:function(e){return"click"},form:function(e){return"submit"},input:function(e){return e.getAttribute("type")=="submit"?"click":"change"},select:function(e){return"change"},textarea:function(e){return"change"}};function Dn(e){var t=e.tagName.toLowerCase();if(t in mn)return mn[t](e)}function x(e){throw new Error(e)}var fn=function(){function e(t,r){this.context=t,this.action=r}return Object.defineProperty(e.prototype,"index",{get:function(){return this.action.index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventTarget",{get:function(){return this.action.eventTarget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.context.identifier},enumerable:!0,configurable:!0}),e.prototype.handleEvent=function(t){this.willBeInvokedByEvent(t)&&this.invokeWithEvent(t)},Object.defineProperty(e.prototype,"eventName",{get:function(){return this.action.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){var t=this.controller[this.methodName];if(typeof t=="function")return t;throw new Error('Action "'+this.action+'" references undefined method "'+this.methodName+'"')},enumerable:!0,configurable:!0}),e.prototype.invokeWithEvent=function(t){try{this.method.call(this.controller,t)}catch(u){var r=this,n=r.identifier,s=r.controller,a=r.element,d=r.index,c={identifier:n,controller:s,element:a,index:d,event:t};this.context.handleError(u,'invoking action "'+this.action+'"',c)}},e.prototype.willBeInvokedByEvent=function(t){var r=t.target;return this.element===r?!0:r instanceof Element&&this.element.contains(r)?this.scope.containsElement(r):!0},Object.defineProperty(e.prototype,"controller",{get:function(){return this.context.controller},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"methodName",{get:function(){return this.action.methodName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scope",{get:function(){return this.context.scope},enumerable:!0,configurable:!0}),e}();var gn=function(){function e(t,r){var n=this;this.element=t,this.started=!1,this.delegate=r,this.elements=new Set,this.mutationObserver=new MutationObserver(function(s){return n.processMutations(s)})}return e.prototype.start=function(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,childList:!0,subtree:!0}),this.refresh())},e.prototype.stop=function(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)},e.prototype.refresh=function(){if(this.started){for(var t=new Set(this.matchElementsInTree()),r=0,n=Array.from(this.elements);r<n.length;r++){var s=n[r];t.has(s)||this.removeElement(s)}for(var a=0,d=Array.from(t);a<d.length;a++){var s=d[a];this.addElement(s)}}},e.prototype.processMutations=function(t){if(this.started)for(var r=0,n=t;r<n.length;r++){var s=n[r];this.processMutation(s)}},e.prototype.processMutation=function(t){t.type=="attributes"?this.processAttributeChange(t.target,t.attributeName):t.type=="childList"&&(this.processRemovedNodes(t.removedNodes),this.processAddedNodes(t.addedNodes))},e.prototype.processAttributeChange=function(t,r){var n=t;this.elements.has(n)?this.delegate.elementAttributeChanged&&this.matchElement(n)?this.delegate.elementAttributeChanged(n,r):this.removeElement(n):this.matchElement(n)&&this.addElement(n)},e.prototype.processRemovedNodes=function(t){for(var r=0,n=Array.from(t);r<n.length;r++){var s=n[r],a=this.elementFromNode(s);a&&this.processTree(a,this.removeElement)}},e.prototype.processAddedNodes=function(t){for(var r=0,n=Array.from(t);r<n.length;r++){var s=n[r],a=this.elementFromNode(s);a&&this.elementIsActive(a)&&this.processTree(a,this.addElement)}},e.prototype.matchElement=function(t){return this.delegate.matchElement(t)},e.prototype.matchElementsInTree=function(t){return t===void 0&&(t=this.element),this.delegate.matchElementsInTree(t)},e.prototype.processTree=function(t,r){for(var n=0,s=this.matchElementsInTree(t);n<s.length;n++){var a=s[n];r.call(this,a)}},e.prototype.elementFromNode=function(t){if(t.nodeType==Node.ELEMENT_NODE)return t},e.prototype.elementIsActive=function(t){return t.isConnected!=this.element.isConnected?!1:this.element.contains(t)},e.prototype.addElement=function(t){this.elements.has(t)||this.elementIsActive(t)&&(this.elements.add(t),this.delegate.elementMatched&&this.delegate.elementMatched(t))},e.prototype.removeElement=function(t){this.elements.has(t)&&(this.elements.delete(t),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(t))},e}();var vn=function(){function e(t,r,n){this.attributeName=r,this.delegate=n,this.elementObserver=new gn(t,this)}return Object.defineProperty(e.prototype,"element",{get:function(){return this.elementObserver.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selector",{get:function(){return"["+this.attributeName+"]"},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.elementObserver.start()},e.prototype.stop=function(){this.elementObserver.stop()},e.prototype.refresh=function(){this.elementObserver.refresh()},Object.defineProperty(e.prototype,"started",{get:function(){return this.elementObserver.started},enumerable:!0,configurable:!0}),e.prototype.matchElement=function(t){return t.hasAttribute(this.attributeName)},e.prototype.matchElementsInTree=function(t){var r=this.matchElement(t)?[t]:[],n=Array.from(t.querySelectorAll(this.selector));return r.concat(n)},e.prototype.elementMatched=function(t){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(t,this.attributeName)},e.prototype.elementUnmatched=function(t){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(t,this.attributeName)},e.prototype.elementAttributeChanged=function(t,r){this.delegate.elementAttributeValueChanged&&this.attributeName==r&&this.delegate.elementAttributeValueChanged(t,r)},e}();function f(e,t,r){yn(e,t).add(r)}function g(e,t,r){yn(e,t).delete(r),Rn(e,t)}function yn(e,t){var r=e.get(t);return r||(r=new Set,e.set(t,r)),r}function Rn(e,t){var r=e.get(t);r!=null&&r.size==0&&e.delete(t)}var m=function(){function e(){this.valuesByKey=new Map}return Object.defineProperty(e.prototype,"values",{get:function(){var t=Array.from(this.valuesByKey.values());return t.reduce(function(r,n){return r.concat(Array.from(n))},[])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var t=Array.from(this.valuesByKey.values());return t.reduce(function(r,n){return r+n.size},0)},enumerable:!0,configurable:!0}),e.prototype.add=function(t,r){f(this.valuesByKey,t,r)},e.prototype.delete=function(t,r){g(this.valuesByKey,t,r)},e.prototype.has=function(t,r){var n=this.valuesByKey.get(t);return n!=null&&n.has(r)},e.prototype.hasKey=function(t){return this.valuesByKey.has(t)},e.prototype.hasValue=function(t){var r=Array.from(this.valuesByKey.values());return r.some(function(n){return n.has(t)})},e.prototype.getValuesForKey=function(t){var r=this.valuesByKey.get(t);return r?Array.from(r):[]},e.prototype.getKeysForValue=function(t){return Array.from(this.valuesByKey).filter(function(r){var n=r[0],s=r[1];return s.has(t)}).map(function(r){var n=r[0],s=r[1];return n})},e}();var On=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Li=function(e){On(t,e);function t(){var r=e.call(this)||this;return r.keysByValue=new Map,r}return Object.defineProperty(t.prototype,"values",{get:function(){return Array.from(this.keysByValue.keys())},enumerable:!0,configurable:!0}),t.prototype.add=function(r,n){e.prototype.add.call(this,r,n),f(this.keysByValue,n,r)},t.prototype.delete=function(r,n){e.prototype.delete.call(this,r,n),g(this.keysByValue,n,r)},t.prototype.hasValue=function(r){return this.keysByValue.has(r)},t.prototype.getKeysForValue=function(r){var n=this.keysByValue.get(r);return n?Array.from(n):[]},t}(m);var bn=function(){function e(t,r,n){this.attributeObserver=new vn(t,r,this),this.delegate=n,this.tokensByElement=new m}return Object.defineProperty(e.prototype,"started",{get:function(){return this.attributeObserver.started},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.attributeObserver.start()},e.prototype.stop=function(){this.attributeObserver.stop()},e.prototype.refresh=function(){this.attributeObserver.refresh()},Object.defineProperty(e.prototype,"element",{get:function(){return this.attributeObserver.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attributeName",{get:function(){return this.attributeObserver.attributeName},enumerable:!0,configurable:!0}),e.prototype.elementMatchedAttribute=function(t){this.tokensMatched(this.readTokensForElement(t))},e.prototype.elementAttributeValueChanged=function(t){var r=this.refreshTokensForElement(t),n=r[0],s=r[1];this.tokensUnmatched(n),this.tokensMatched(s)},e.prototype.elementUnmatchedAttribute=function(t){this.tokensUnmatched(this.tokensByElement.getValuesForKey(t))},e.prototype.tokensMatched=function(t){var r=this;t.forEach(function(n){return r.tokenMatched(n)})},e.prototype.tokensUnmatched=function(t){var r=this;t.forEach(function(n){return r.tokenUnmatched(n)})},e.prototype.tokenMatched=function(t){this.delegate.tokenMatched(t),this.tokensByElement.add(t.element,t)},e.prototype.tokenUnmatched=function(t){this.delegate.tokenUnmatched(t),this.tokensByElement.delete(t.element,t)},e.prototype.refreshTokensForElement=function(t){var r=this.tokensByElement.getValuesForKey(t),n=this.readTokensForElement(t),s=Hn(r,n).findIndex(function(a){var d=a[0],c=a[1];return!Vn(d,c)});return s==-1?[[],[]]:[r.slice(s),n.slice(s)]},e.prototype.readTokensForElement=function(t){var r=this.attributeName,n=t.getAttribute(r)||"";return Fn(n,t,r)},e}();function Fn(e,t,r){return e.trim().split(/\s+/).filter(function(n){return n.length}).map(function(n,s){return{element:t,attributeName:r,content:n,index:s}})}function Hn(e,t){var r=Math.max(e.length,t.length);return Array.from({length:r},function(n,s){return[e[s],t[s]]})}function Vn(e,t){return e&&t&&e.index==t.index&&e.content==t.content}var v=function(){function e(t,r,n){this.tokenListObserver=new bn(t,r,this),this.delegate=n,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}return Object.defineProperty(e.prototype,"started",{get:function(){return this.tokenListObserver.started},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.tokenListObserver.start()},e.prototype.stop=function(){this.tokenListObserver.stop()},e.prototype.refresh=function(){this.tokenListObserver.refresh()},Object.defineProperty(e.prototype,"element",{get:function(){return this.tokenListObserver.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attributeName",{get:function(){return this.tokenListObserver.attributeName},enumerable:!0,configurable:!0}),e.prototype.tokenMatched=function(t){var r=t.element,n=this.fetchParseResultForToken(t).value;n&&(this.fetchValuesByTokenForElement(r).set(t,n),this.delegate.elementMatchedValue(r,n))},e.prototype.tokenUnmatched=function(t){var r=t.element,n=this.fetchParseResultForToken(t).value;n&&(this.fetchValuesByTokenForElement(r).delete(t),this.delegate.elementUnmatchedValue(r,n))},e.prototype.fetchParseResultForToken=function(t){var r=this.parseResultsByToken.get(t);return r||(r=this.parseToken(t),this.parseResultsByToken.set(t,r)),r},e.prototype.fetchValuesByTokenForElement=function(t){var r=this.valuesByTokenByElement.get(t);return r||(r=new Map,this.valuesByTokenByElement.set(t,r)),r},e.prototype.parseToken=function(t){try{var r=this.delegate.parseValueForToken(t);return{value:r}}catch(n){return{error:n}}},e}();var Tn=function(){function e(t,r){this.context=t,this.delegate=r,this.bindingsByAction=new Map}return e.prototype.start=function(){this.valueListObserver||(this.valueListObserver=new v(this.element,this.actionAttribute,this),this.valueListObserver.start())},e.prototype.stop=function(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())},Object.defineProperty(e.prototype,"element",{get:function(){return this.context.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.context.identifier},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actionAttribute",{get:function(){return this.schema.actionAttribute},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this.context.schema},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bindings",{get:function(){return Array.from(this.bindingsByAction.values())},enumerable:!0,configurable:!0}),e.prototype.connectAction=function(t){var r=new fn(this.context,t);this.bindingsByAction.set(t,r),this.delegate.bindingConnected(r)},e.prototype.disconnectAction=function(t){var r=this.bindingsByAction.get(t);r&&(this.bindingsByAction.delete(t),this.delegate.bindingDisconnected(r))},e.prototype.disconnectAllActions=function(){var t=this;this.bindings.forEach(function(r){return t.delegate.bindingDisconnected(r)}),this.bindingsByAction.clear()},e.prototype.parseValueForToken=function(t){var r=pn.forToken(t);if(r.identifier==this.identifier)return r},e.prototype.elementMatchedValue=function(t,r){this.connectAction(r)},e.prototype.elementUnmatchedValue=function(t,r){this.disconnectAction(r)},e}();var L=function(){function e(t,r){this.module=t,this.scope=r,this.controller=new t.controllerConstructor(this),this.bindingObserver=new Tn(this,this.dispatcher);try{this.controller.initialize()}catch(n){this.handleError(n,"initializing controller")}}return e.prototype.connect=function(){this.bindingObserver.start();try{this.controller.connect()}catch(t){this.handleError(t,"connecting controller")}},e.prototype.disconnect=function(){try{this.controller.disconnect()}catch(t){this.handleError(t,"disconnecting controller")}this.bindingObserver.stop()},Object.defineProperty(e.prototype,"application",{get:function(){return this.module.application},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.module.identifier},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this.application.schema},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dispatcher",{get:function(){return this.application.dispatcher},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return this.element.parentElement},enumerable:!0,configurable:!0}),e.prototype.handleError=function(t,r,n){n===void 0&&(n={});var s=this,a=s.identifier,d=s.controller,c=s.element;n=Object.assign({identifier:a,controller:d,element:c},n),this.application.handleError(t,"Error "+r,n)},e}();var Un=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function xn(e){return{identifier:e.identifier,controllerConstructor:$n(e.controllerConstructor)}}function $n(e){var t=zn(e);return t.bless(),t}var zn=function(){function e(r){function n(){var s=this&&this instanceof n?this.constructor:void 0;return Reflect.construct(r,arguments,s)}return n.prototype=Object.create(r.prototype,{constructor:{value:n}}),Reflect.setPrototypeOf(n,r),n}function t(){var r=function(){this.a.call(this)},n=e(r);return n.prototype.a=function(){},new n}try{return t(),e}catch{return function(n){return function(s){Un(a,s);function a(){return s!==null&&s.apply(this,arguments)||this}return a}(n)}}}();var Ln=function(){function e(t,r){this.application=t,this.definition=xn(r),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}return Object.defineProperty(e.prototype,"identifier",{get:function(){return this.definition.identifier},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"controllerConstructor",{get:function(){return this.definition.controllerConstructor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contexts",{get:function(){return Array.from(this.connectedContexts)},enumerable:!0,configurable:!0}),e.prototype.connectContextForScope=function(t){var r=this.fetchContextForScope(t);this.connectedContexts.add(r),r.connect()},e.prototype.disconnectContextForScope=function(t){var r=this.contextsByScope.get(t);r&&(this.connectedContexts.delete(r),r.disconnect())},e.prototype.fetchContextForScope=function(t){var r=this.contextsByScope.get(t);return r||(r=new L(this,t),this.contextsByScope.set(t,r)),r},e}();var Cn=function(){function e(t){this.scope=t}return Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.scope.identifier},enumerable:!0,configurable:!0}),e.prototype.get=function(t){return t=this.getFormattedKey(t),this.element.getAttribute(t)},e.prototype.set=function(t,r){return t=this.getFormattedKey(t),this.element.setAttribute(t,r),this.get(t)},e.prototype.has=function(t){return t=this.getFormattedKey(t),this.element.hasAttribute(t)},e.prototype.delete=function(t){return this.has(t)?(t=this.getFormattedKey(t),this.element.removeAttribute(t),!0):!1},e.prototype.getFormattedKey=function(t){return"data-"+this.identifier+"-"+qn(t)},e}();function qn(e){return e.replace(/([A-Z])/g,function(t,r){return"-"+r.toLowerCase()})}function y(e,t){return"["+e+'~="'+t+'"]'}var _n=function(){function e(t){this.scope=t}return Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.scope.identifier},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this.scope.schema},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this.find(t)!=null},e.prototype.find=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.getSelectorForTargetNames(t);return this.scope.findElement(n)},e.prototype.findAll=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.getSelectorForTargetNames(t);return this.scope.findAllElements(n)},e.prototype.getSelectorForTargetNames=function(t){var r=this;return t.map(function(n){return r.getSelectorForTargetName(n)}).join(", ")},e.prototype.getSelectorForTargetName=function(t){var r=this.identifier+"."+t;return y(this.schema.targetAttribute,r)},e}();var wn=function(){function e(t,r,n){this.schema=t,this.identifier=r,this.element=n,this.targets=new _n(this),this.data=new Cn(this)}return e.prototype.findElement=function(t){return this.findAllElements(t)[0]},e.prototype.findAllElements=function(t){var r=this.element.matches(t)?[this.element]:[],n=this.filterElements(Array.from(this.element.querySelectorAll(t)));return r.concat(n)},e.prototype.filterElements=function(t){var r=this;return t.filter(function(n){return r.containsElement(n)})},e.prototype.containsElement=function(t){return t.closest(this.controllerSelector)===this.element},Object.defineProperty(e.prototype,"controllerSelector",{get:function(){return y(this.schema.controllerAttribute,this.identifier)},enumerable:!0,configurable:!0}),e}();var In=function(){function e(t,r,n){this.element=t,this.schema=r,this.delegate=n,this.valueListObserver=new v(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}return e.prototype.start=function(){this.valueListObserver.start()},e.prototype.stop=function(){this.valueListObserver.stop()},Object.defineProperty(e.prototype,"controllerAttribute",{get:function(){return this.schema.controllerAttribute},enumerable:!0,configurable:!0}),e.prototype.parseValueForToken=function(t){var r=t.element,n=t.content,s=this.fetchScopesByIdentifierForElement(r),a=s.get(n);return a||(a=new wn(this.schema,n,r),s.set(n,a)),a},e.prototype.elementMatchedValue=function(t,r){var n=(this.scopeReferenceCounts.get(r)||0)+1;this.scopeReferenceCounts.set(r,n),n==1&&this.delegate.scopeConnected(r)},e.prototype.elementUnmatchedValue=function(t,r){var n=this.scopeReferenceCounts.get(r);n&&(this.scopeReferenceCounts.set(r,n-1),n==1&&this.delegate.scopeDisconnected(r))},e.prototype.fetchScopesByIdentifierForElement=function(t){var r=this.scopesByIdentifierByElement.get(t);return r||(r=new Map,this.scopesByIdentifierByElement.set(t,r)),r},e}();var Bn=function(){function e(t){this.application=t,this.scopeObserver=new In(this.element,this.schema,this),this.scopesByIdentifier=new m,this.modulesByIdentifier=new Map}return Object.defineProperty(e.prototype,"element",{get:function(){return this.application.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this.application.schema},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"controllerAttribute",{get:function(){return this.schema.controllerAttribute},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modules",{get:function(){return Array.from(this.modulesByIdentifier.values())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contexts",{get:function(){return this.modules.reduce(function(t,r){return t.concat(r.contexts)},[])},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.scopeObserver.start()},e.prototype.stop=function(){this.scopeObserver.stop()},e.prototype.loadDefinition=function(t){this.unloadIdentifier(t.identifier);var r=new Ln(this.application,t);this.connectModule(r)},e.prototype.unloadIdentifier=function(t){var r=this.modulesByIdentifier.get(t);r&&this.disconnectModule(r)},e.prototype.getContextForElementAndIdentifier=function(t,r){var n=this.modulesByIdentifier.get(r);if(n)return n.contexts.find(function(s){return s.element==t})},e.prototype.handleError=function(t,r,n){this.application.handleError(t,r,n)},e.prototype.scopeConnected=function(t){this.scopesByIdentifier.add(t.identifier,t);var r=this.modulesByIdentifier.get(t.identifier);r&&r.connectContextForScope(t)},e.prototype.scopeDisconnected=function(t){this.scopesByIdentifier.delete(t.identifier,t);var r=this.modulesByIdentifier.get(t.identifier);r&&r.disconnectContextForScope(t)},e.prototype.connectModule=function(t){this.modulesByIdentifier.set(t.identifier,t);var r=this.scopesByIdentifier.getValuesForKey(t.identifier);r.forEach(function(n){return t.connectContextForScope(n)})},e.prototype.disconnectModule=function(t){this.modulesByIdentifier.delete(t.identifier);var r=this.scopesByIdentifier.getValuesForKey(t.identifier);r.forEach(function(n){return t.disconnectContextForScope(n)})},e}();var C={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target"};var Wn=function(e,t,r,n){return new(r||(r=Promise))(function(s,a){function d(l){try{u(n.next(l))}catch(h){a(h)}}function c(l){try{u(n.throw(l))}catch(h){a(h)}}function u(l){l.done?s(l.value):new r(function(h){h(l.value)}).then(d,c)}u((n=n.apply(e,t||[])).next())})},Yn=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,s,a,d;return d={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function c(l){return function(h){return u([l,h])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(a=s[l[0]&2?"return":l[0]?"throw":"next"])&&!(a=a.call(s,l[1])).done)return a;switch(s=0,a&&(l=[0,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,s=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(h){l=[6,h],s=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},_=function(){function e(t,r){t===void 0&&(t=document.documentElement),r===void 0&&(r=C),this.element=t,this.schema=r,this.dispatcher=new cn(this),this.router=new Bn(this)}return e.start=function(t,r){var n=new e(t,r);return n.start(),n},e.prototype.start=function(){return Wn(this,void 0,void 0,function(){return Yn(this,function(t){switch(t.label){case 0:return[4,Jn()];case 1:return t.sent(),this.router.start(),this.dispatcher.start(),[2]}})})},e.prototype.stop=function(){this.router.stop(),this.dispatcher.stop()},e.prototype.register=function(t,r){this.load({identifier:t,controllerConstructor:r})},e.prototype.load=function(t){for(var r=this,n=[],s=1;s<arguments.length;s++)n[s-1]=arguments[s];var a=Array.isArray(t)?t:[t].concat(n);a.forEach(function(d){return r.router.loadDefinition(d)})},e.prototype.unload=function(t){for(var r=this,n=[],s=1;s<arguments.length;s++)n[s-1]=arguments[s];var a=Array.isArray(t)?t:[t].concat(n);a.forEach(function(d){return r.router.unloadIdentifier(d)})},Object.defineProperty(e.prototype,"controllers",{get:function(){return this.router.contexts.map(function(t){return t.controller})},enumerable:!0,configurable:!0}),e.prototype.getControllerForElementAndIdentifier=function(t,r){var n=this.router.getContextForElementAndIdentifier(t,r);return n?n.controller:null},e.prototype.handleError=function(t,r,n){console.error(`%s

%o

%o`,r,t,n)},e}();function Jn(){return new Promise(function(e){document.readyState=="loading"?document.addEventListener("DOMContentLoaded",e):e()})}function An(e){var t=e.prototype,r=Kn(e);r.forEach(function(n){var s;return Xn(t,(s={},s[n+"Target"]={get:function(){var a=this.targets.find(n);if(a)return a;throw new Error('Missing target element "'+this.identifier+"."+n+'"')}},s[n+"Targets"]={get:function(){return this.targets.findAll(n)}},s["has"+Zn(n)+"Target"]={get:function(){return this.targets.has(n)}},s))})}function Kn(e){var t=Gn(e);return Array.from(t.reduce(function(r,n){return Qn(n).forEach(function(s){return r.add(s)}),r},new Set))}function Gn(e){for(var t=[];e;)t.push(e),e=Object.getPrototypeOf(e);return t}function Qn(e){var t=e.targets;return Array.isArray(t)?t:[]}function Xn(e,t){Object.keys(t).forEach(function(r){if(!(r in e)){var n=t[r];Object.defineProperty(e,r,n)}})}function Zn(e){return e.charAt(0).toUpperCase()+e.slice(1)}var i=function(){function e(t){this.context=t}return e.bless=function(){An(this)},Object.defineProperty(e.prototype,"application",{get:function(){return this.context.application},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scope",{get:function(){return this.context.scope},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.scope.identifier},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"targets",{get:function(){return this.scope.targets},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.scope.data},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){},e.prototype.connect=function(){},e.prototype.disconnect=function(){},e.targets=[],e}();function ei(e,t){return[...new Set(e.split("--").filter(n=>!["..",t].includes(n)))].join("--")}function En(e,t,r){t.forEach(n=>{e.register(ei(n.name,r),n.module.default)})}var I={};o(I,{default:()=>w});var w=class extends i{static targets=["patientHistoryLimitDiv","patientHistoryLimit","addPatientHistoryLimitButton"];showPatientHistoryLimitDiv(){this.patientHistoryLimitDivTarget.classList.remove("hidden"),this.addPatientHistoryLimitButtonTarget.classList.add("hidden")}removePatientHistoryLimit(){this.patientHistoryLimitTarget.value="",this.patientHistoryLimitDivTarget.classList.add("hidden"),this.addPatientHistoryLimitButtonTarget.classList.remove("hidden")}};var A={};o(A,{default:()=>B});var B=class extends i{static targets=["ageInDays","ageMetric","ageInput"];setAgeInDays(){this.valid()&&(this.ageMetricTarget.value==="years"?this.ageInDaysTarget.value=parseInt(this.ageInputTarget.value)*365:this.ageMetricTarget.value==="days"&&(this.ageInDaysTarget.value=this.ageInputTarget.value))}valid(){if(this.ageMetricTarget.value==="years")return parseInt(this.ageInputTarget.value)>110?(alert("Age in years cannot be greater than 110"),!1):!0;if(this.ageMetricTarget.value==="days")return parseInt(this.ageInputTarget.value)>364?(alert("Age in days cannot be greater than 364"),!1):!0}};var S={};o(S,{default:()=>E});var E=class extends i{static targets=["selectBox"];connect(){$(".popup-select-box").select2({placeholder:function(){$(this).data("placeholder")},allowClear:!0})}};var k={};o(k,{default:()=>M});var M=class extends i{static targets=["input","display","displayText","saveBtns","requestReviewBtns"];labIdentifier(){return document.getElementById("lab_identifier").value}edit(){this.displayTarget.classList.add("hidden"),this.inputTarget.classList.remove("hidden"),this.saveBtnsTarget.classList.remove("hidden"),this.requestReviewBtnsTarget.classList.add("hidden")}cancel(){this.displayTarget.classList.remove("hidden"),this.inputTarget.classList.add("hidden"),this.saveBtnsTarget.classList.add("hidden"),this.requestReviewBtnsTarget.classList.remove("hidden")}send(){var e=this.inputTarget.dataset.patientName,t=this.inputTarget.dataset.countryDialCode,r=this.inputTarget.dataset.mobileNumber,n=this.inputTarget.value;r===void 0||r===""?alert("Mobile number not found. Please update patient mobile number."):n.includes("[Enter link here]")?alert("Please click on edit and update [Enter link here] with link to review."):(n=n.replace("PATIENT_NAME",e),n=encodeURIComponent(n),window.open("https://web.whatsapp.com/send?phone="+t+r+"&text="+n))}validateAndSave(){var e=this.inputTarget.value;e.includes("PATIENT_NAME")?this.save():alert("PATIENT_NAME must be present.")}save(){var e=JSON.stringify({ask_review_text:this.inputTarget.value}),t="/"+this.labIdentifier()+"/ask_review/update";fetch(t,{method:"POST",body:e,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(r=>this.processResponse(r))}processResponse(e){e.json().then(t=>{t.ask_review_text!==""?(this.displayTextTarget.innerHTML=t.ask_review_text,this.displayTarget.classList.remove("hidden"),this.inputTarget.classList.add("hidden"),this.saveBtnsTarget.classList.add("hidden"),this.requestReviewBtnsTarget.classList.remove("hidden")):alert("Something went wrong! Failed to save.")})}};var j={};o(j,{default:()=>P});var P=class extends i{static targets=["input"];insertText(e){this.inputTarget.value=e.currentTarget.innerText}needsInput(){this.inputTarget.value="",this.inputTarget.placeholder="Please enter your text..."}};var D={};o(D,{default:()=>N});var N=class extends i{static targets=["image"];static values={attemptsRemaining:{type:Number}};initialize(){this.attemptsRemaining=3}urlValue(){return this.element.dataset.urlValue}connect(){this.hasImageTarget||this.load()}delay(e){return new Promise(t=>setTimeout(t,e))}load(){fetch(this.urlValue()).then(e=>e.json()).then(e=>this.processResponseJson(e))}processResponseJson(e){e.reg_no_barcode_url!==null?this.element.innerHTML=`<img src=${e.reg_no_barcode_url}>`:(this.attemptsRemaining=this.attemptsRemaining-1,this.attemptsRemaining>0&&this.delay(2e3).then(()=>this.load()))}};var O={};o(O,{default:()=>R});function b(e,t){return t.includes(e)}function T(e){let r="/"+document.getElementById("lab_identifier").value+"/introjs/update_intro_js_state";var n=JSON.stringify({key:e});fetch(r,{method:"PATCH",body:n,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}})}var R=class extends i{connect(){b("billPageIntroComplete",this.element.dataset.introjsState)||introJs().oncomplete(this.markIntroComplete).start()}markIntroComplete(){T("billPageIntroComplete")}};var H={};o(H,{default:()=>F});var F=class extends i{static targets=["urlButton","spinnerContainer","pdfIconContainer"];static values={attemptsRemaining:{type:Number}};initialize(){this.attemptsRemaining=2,this.caseId=this.urlButtonTarget.dataset.kaseId,this.labIdentifier=this.urlButtonTarget.dataset.labIdentifier,this.PdfGenerationUrl=`/${this.labIdentifier}/cases/${this.caseId}/generate_bill_pdf`,this.pdfPollingUrl=`/${this.labIdentifier}/cases/${this.caseId}/bill_pdf_url`}delay(e){return new Promise(t=>setTimeout(t,e))}generate(){this.urlButtonTarget.dataset.pdfUrl?this.urlButtonTarget.href=this.urlButtonTarget.dataset.pdfUrl:(this.spinnerContainerTarget.classList.remove("hidden"),this.pdfIconContainerTarget.classList.add("hidden"),this.urlButtonTarget.classList.add("primary-btn-disabled"),fetch(this.PdfGenerationUrl,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(()=>{setTimeout(()=>this.pollUrl(this.pdfPollingUrl),1e3)}).catch(e=>console.error("Error:",e)))}pollUrl(e){fetch(e).then(t=>t.json()).then(t=>{this.processResponseJson(t),t.url})}processResponseJson(e){e.url!==null?(this.urlButtonTarget.href=e.url,this.spinnerContainerTarget.classList.add("hidden"),this.pdfIconContainerTarget.classList.remove("hidden"),this.urlButtonTarget.classList.remove("primary-btn-disabled"),window.open(e.url)):(this.attemptsRemaining=this.attemptsRemaining-1,this.attemptsRemaining>0?this.delay(1e3).then(()=>this.pollUrl(this.pdfPollingUrl)):alert("Sorry, failed to load PDF. Please contact support by raising a support ticket."))}};var U={};o(U,{default:()=>V});var V=class extends i{static targets=["managePermission","dependentPermissionsDiv"];connect(){this.hideShowDependentPermissions()}hideShowDependentPermissions(){this.managePermissionTarget.checked?this.dependentPermissionsDivTarget.classList.remove("hidden"):this.dependentPermissionsDivTarget.classList.add("hidden")}};var q={};o(q,{default:()=>z});var z=class extends i{static targets=["limitDiv","limit","addLimitButton"];showLimitDiv(){this.limitDivTarget.classList.remove("hidden"),this.addLimitButtonTarget.classList.add("hidden")}removeLimit(){this.limitTarget.value="",this.limitDivTarget.classList.add("hidden"),this.addLimitButtonTarget.classList.remove("hidden")}};var Y={};o(Y,{default:()=>W});var W=class extends i{static targets=[];initialize(){this.state="Closed"}toggleExpandCollase(e){e.preventDefault(),this.element.querySelector("i").classList.toggle("fa-angle-right"),this.element.querySelector("i").classList.toggle("fa-angle-down"),this.element.parentNode.parentNode.querySelectorAll(".more-info").forEach(function(t){t.classList.toggle("hide")})}toggleExpandCollaseAll(e){e.preventDefault(),this.element.querySelector("i").classList.toggle("fa-angle-right"),this.element.querySelector("i").classList.toggle("fa-angle-down"),this.state==="Closed"?(document.querySelectorAll("tr.more-info").forEach(function(t){t.classList.remove("hide")}),document.querySelectorAll("a.toggle-expand-case i").forEach(function(t){t.classList.remove("fa-angle-right"),t.classList.add("fa-angle-down")}),this.state="Open"):(document.querySelectorAll("tr.more-info").forEach(function(t){t.classList.add("hide")}),document.querySelectorAll("a.toggle-expand-case i").forEach(function(t){t.classList.add("fa-angle-right"),t.classList.remove("fa-angle-down")}),this.state="Closed")}};var K={};o(K,{default:()=>J});var J=class extends i{static targets=[];remove(e){e.preventDefault(),this.element.remove()}};var Q={};o(Q,{default:()=>G});var G=class extends i{static targets=["counter","counterContainer"];updateCounter(e){var t=e.currentTarget.value.length;t>200&&(e.currentTarget.value=e.currentTarget.value.slice(0,200),t=e.currentTarget.value.length),this.counterTarget.innerHTML=200-t,this.formatCounterContainer(t)}formatCounterContainer(e){e==200?this.counterContainerTarget.style.color="red":this.counterContainerTarget.style.color=""}};var Z={};o(Z,{default:()=>X});var X=class extends i{static targets=["errorDiv","errorMessage"];perform(e){var t=e.currentTarget;t.checked===!1?(this.errorMessageTarget.innerText="Should be checked.",this.errorDivTarget.classList.remove("hidden"),t.dataset.valid="false"):(this.errorMessageTarget.innerText="",this.errorDivTarget.classList.add("hidden"),t.dataset.valid="true")}};var te={};o(te,{default:()=>ee});var ee=class extends i{static targets=["source"];copy(e){e.preventDefault();var t=this.sourceTarget.value;navigator.clipboard.writeText(t)}copyActiveTinymceContent(){tinyMCE.activeEditor.selection.select(tinyMCE.activeEditor.getBody()),tinyMCE.activeEditor.execCommand("Copy")}};var ne={};o(ne,{default:()=>re});var re=class extends i{static targets=["iframe","spinner","letterheadCheckbox"];static values={refreshInterval:Number,remainingAttempts:Number};initialize(){this.refreshIntervalValue=1e3,this.remainingAttempts=4,this.pdfWithLetterheadUrl=null,this.pdfWithoutLetterheadUrl=null}toggleWithLetterhead(){this.loadIframe()}getPdfUrls(){var e="/"+this.labIdentifier()+"/configure_lab_report/pdf_urls/"+this.reportId();fetch(e).then(t=>t.json()).then(t=>this.processResponse(t))}processResponse(e){this.pdfWithLetterheadUrl=e.pdf_with_letterhead_url,this.pdfWithoutLetterheadUrl=e.pdf_without_letterhead_url,console.log(`Remaining attempts ${this.remainingAttempts} pdfWithLetterheadUrl ${this.pdfWithLetterheadUrl} and pdfWithoutLetterheadUrl ${this.pdfWithoutLetterheadUrl}`),this.pdfWithLetterheadUrl!==null&&this.pdfWithoutLetterheadUrl!==null&&this.stopRefreshing(),this.loadIframe()}getSrc(){return this.letterheadCheckboxTarget.checked?this.pdfWithLetterheadUrl:this.pdfWithoutLetterheadUrl}loadIframe(){var e=this.getSrc();e!==null&&(this.iframeTarget.src=e+"#toolbar=0",this.spinnerTarget.classList.add("hidden"),this.iframeTarget.classList.remove("hidden"))}labIdentifier(){return document.getElementById("lab_identifier").value}reportId(){return document.getElementById("lab_report_id").value}connect(){this.startRefreshing()}disconnect(){this.stopRefreshing()}startRefreshing(){this.spinnerTarget.classList.remove("hidden"),this.iframeTarget.classList.add("hidden"),this.getPdfUrls(),this.refreshTimer=setInterval(()=>{this.remainingAttempts=this.remainingAttempts-1,this.remainingAttempts>0&&this.getPdfUrls(),this.remainingAttempts==0&&(alert("Failed to load PDF. Please try again."),this.spinnerTarget.classList.add("hidden"))},this.refreshIntervalValue)}stopRefreshing(){this.refreshTimer&&clearInterval(this.refreshTimer)}};var se={};o(se,{default:()=>ie});var ie=class extends i{static targets=["bodyContainer","mobileNumber","query","spinnerContainer","fileAttachment","uploadProgress"];connect(){[null,""].includes(this.getUrlParams().get("source"))||this.loadTicketForm()}getUrlParams(){return new URLSearchParams(window.location.search)}labIdentifier(){return document.getElementById("lab_identifier").value}labCountryCode(){return document.getElementById("lab_country_code").value}loadTicketForm(){this.insertSpinner();let e="/"+this.labIdentifier()+"/dashboard/support_ticket_form?"+this.getUrlParams().toString();fetch(e).then(t=>t.text()).then(t=>this.bodyContainerTarget.innerHTML=t)}validateAndCreate(){this.valid()&&this.createTicket()}valid(){return this.mobileNumberValid()&&this.queryValid()&&this.UploadFinished()}indianLab(){return this.labCountryCode()=="IN"}mobileNumberValid(){return this.indianLab()&&this.mobileNumberTarget.value.length!=10||!this.indianLab()&&this.mobileNumberTarget.value.length<5?(this.mobileNumberTarget.style.borderColor="red",alert("Invalid mobile number"),!1):!0}queryValid(){return this.queryTarget.value.length==0?(this.queryTarget.style.borderColor="red",alert("Please enter your request"),!1):!0}UploadFinished(){return this.uploadProgressTarget.hidden?!0:(alert("Please wait for upload to finish"),!1)}createTicket(){this.insertSpinner();let e="/"+this.labIdentifier()+"/dashboard/create_ticket";console.log(this.mobileNumberTarget.value),console.log(this.queryTarget.value),console.log(this.fileAttachmentTarget.value);var t=JSON.stringify({mobile_number:this.mobileNumberTarget.value,query:this.queryTarget.value,files:this.fileAttachmentTarget.value});fetch(e,{method:"POST",body:t,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(r=>r.text()).then(r=>this.bodyContainerTarget.innerHTML=r)}insertSpinner(){var e=`<svg class="h-5 w-5 mr-2 spinner-svg" viewBox="0 0 24 24">
                  <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
                    <circle cx="11" cy="11" r="11"></circle>
                    <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
                  </g>
                </svg>`;this.spinnerContainerTarget.innerHTML=e}};var oe={};o(oe,{default:()=>ae});var ae=class extends i{static targets=["reasonFieldDiv","discountField","reasonField"];askWithDelay(){setTimeout(()=>{this.ask()},300)}ask(){if(this.hasReasonFieldDivTarget){var e=this.discountFieldTarget.value,t=this.discountFieldTarget.dataset.initialDiscountValue;e===""||parseInt(e)===parseInt(t)?(this.reasonFieldDivTarget.classList.add("hidden"),this.reasonFieldTarget.removeAttribute("required")):(this.reasonFieldDivTarget.classList.remove("hidden"),this.reasonFieldTarget.setAttribute("required","required"))}}};var de={};o(de,{default:()=>le});var le=class extends i{static targets=["discountTypeFieldDiv","discountField","discountTypeField"];askWithDelay(){setTimeout(()=>{this.ask()},300)}ask(){var e=this.discountTypeFieldTarget.value;e!==""&&this.updateCasebleDiscountFields();var t=parseInt(this.discountFieldTarget.value);t>0?(this.discountTypeFieldDivTarget.classList.remove("hidden"),this.discountTypeFieldTarget.setAttribute("required","required")):(this.discountTypeFieldDivTarget.classList.add("hidden"),this.discountTypeFieldTarget.removeAttribute("required","required"))}updateCasebleDiscountFields(){var e=this.discountTypeFieldTarget.value,t=document.getElementsByClassName("caseable-discount-type-field");Array.from(t).forEach(r=>{r.value=e})}};var ue={};o(ue,{default:()=>ce});var ce=class extends i{static targets=["errorDiv","errorMessage"];perform(e){var t=e.currentTarget;this.emailInvalid(t.value)?(this.errorMessageTarget.innerText="Email format invalid.",t.style.borderColor="#ef4444",this.errorDivTarget.classList.remove("hidden"),t.dataset.valid="false"):(this.errorMessageTarget.innerText="",t.style.removeProperty("border"),this.errorDivTarget.classList.add("hidden"),t.dataset.valid="true")}emailInvalid(e){return!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}};var me={};o(me,{default:()=>he});var he=class extends i{static targets=["endsInSpan"];connect(){this.daysRemaining()>1?this.setDaysRemaining():this.timer=setInterval(this.runCountdown.bind(this),1e3)}disconnect(){this.timer&&clearInterval(this.timer)}offerEndsAt(){let e=this.endsInSpanTarget.dataset.endsAt;return new Date(e)}runCountdown(){let e=new Date,t=this.offerEndsAt()-e,r=Math.floor(t/(1e3*60*60*24)),n=Math.floor(t%(1e3*60*60*24)/(1e3*60*60)),s=Math.floor(t%(1e3*60*60)/(1e3*60)),a=Math.floor(t%(1e3*60)/1e3);r==1?this.endsInSpanTarget.innerText=`Ends in ${r}day ${n}h ${s}m ${a}s.`:this.endsInSpanTarget.innerText=`Ends in ${n}h ${s}m ${a}s.`}daysRemaining(){let e=new Date,t=this.offerEndsAt()-e;return Math.floor(t/(1e3*60*60*24))}setDaysRemaining(){let e=this.daysRemaining();this.endsInSpanTarget.innerText=`Ends in ${e} days.`}};var fe={};o(fe,{default:()=>pe});var pe=class extends i{static targets=[];validateAndSubmit(e){var t=this.element.getElementsByTagName("input"),r=this.element.getElementsByTagName("select"),n=Array.from(t).concat(Array.from(r));this.revalidateAll(n);var s=!1;if(n.forEach(a=>{a.dataset.valid=="false"&&(s=!0)}),s){e.preventDefault();return}}revalidateAll(e){e.forEach(t=>{var r=new Event("change");t.dispatchEvent(r)})}};var ve={};o(ve,{default:()=>ge});var ge=class extends i{static targets=["modal"];open(){this.modalTarget.classList.remove("hidden")}close(){this.modalTarget.classList.add("hidden")}};var be={};o(be,{default:()=>ye});var ye=class extends i{static targets=["disclaimerNotAcceptedMessage","disclaimerAcceptCheckbox","applicationProcessModal","spinnerContainer"];labIdentifier(){return document.getElementById("lab_identifier").value}removeDisclaimerNotAcceptedMessage(){this.disclaimerNotAcceptedMessageTarget.innerHTML=""}disclaimerAcceptCheckAndCreateRequest(e){this.disclaimerAcceptCheckboxTarget.checked?this.createRequest(e):this.disclaimerNotAcceptedMessageTarget.innerHTML=`
<svg class="h-4 w-4 mr-1 text-red-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>

<div class="text-red-500 text-sm">Kindly check the checkbox above.</div>
`}createRequest(e){this.insertSpinner();let t="/"+this.labIdentifier()+"/free_plan_request";fetch(t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(r=>{r.status==200?this.requestSuccessProcess():r.status==422&&alert("You have an existing free plan request.")})}requestSuccessProcess(){this.removeSpinner(),this.applicationProcessModalTarget.classList.remove("hidden")}insertSpinner(){var e=`<svg class="h-5 w-5 mr-2 spinner-svg" viewBox="0 0 24 24">
                  <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
                    <circle cx="11" cy="11" r="11"></circle>
                    <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
                  </g>
                </svg>`;this.spinnerContainerTarget.innerHTML=e}removeSpinner(){this.spinnerContainerTarget.innerHTML=""}};var xe={};o(xe,{default:()=>Te});var Te=class extends i{static targets=[];toggleHide(e){this.element.querySelector("i").classList.toggle("fa-angle-right"),this.element.querySelector("i").classList.toggle("fa-angle-down"),this.element.querySelectorAll(".checklist-answer-box").forEach(function(t){t.classList.toggle("hide")})}};var Ce={};o(Ce,{default:()=>Le});var Le=class extends i{static targets=["downIcon","upIcon","subMenu"];connect(){this.highlightActiveElement()}highlightActiveElement(){let e=this.element.querySelectorAll("a");Array.from(e).forEach(t=>{t.pathname==location.pathname&&t.classList.add("active")})}};var we={};o(we,{default:()=>_e});var _e=class extends i{static targets=[];connect(e){var t=document.getElementById("load-popup-button");t!==null&&t.click()}};var Be={};o(Be,{default:()=>Ie});var Ie=class extends i{static targets=["billOnly"];hideTestAndPanelInputs(){$(".ratelist-item-tests-panels").toggleClass("hide"),$("#lab_case_investigation_lab_test_ids").val(null).trigger("change"),$("#lab_case_investigation_lab_test_panel_ids").val(null).trigger("change")}};var Ee={};o(Ee,{default:()=>Ae});var Ae=class extends i{static targets=["managePermission","dependentPermissionsDiv"];connect(){this.hideShowDependentPermissions()}hideShowDependentPermissions(){this.managePermissionTarget.checked?this.dependentPermissionsDivTarget.classList.remove("hidden"):this.dependentPermissionsDivTarget.classList.add("hidden")}};var Me={};o(Me,{default:()=>Se});var Se=class extends i{static targets=[];testIdValue(){return this.element.dataset.labTestId}textAreaIdValue(){return"textarea-"+this.testIdValue()+"-interpretation"}loadView(){let e=this.element.dataset.viewUrl;fetch(e).then(t=>t.text()).then(t=>{tinymce.remove("#"+this.textAreaIdValue()),this.element.innerHTML=t})}edit(e){this.insertSpinner(e);let t=this.element.dataset.editUrl;fetch(t).then(r=>r.text()).then(r=>{tinymce.remove("#"+this.textAreaIdValue()),this.element.innerHTML=r})}update(e){this.insertSpinner(e);let t=this.element.dataset.updateUrl;var r=JSON.stringify({interpretation:tinymce.get(this.textAreaIdValue()).getContent()});fetch(t,{method:"PATCH",body:r,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(n=>{n.status==200?this.loadView():alert("Failed")})}cancel(e){this.insertSpinner(e),this.loadView()}insertSpinner(e){var t=`<svg class="h-3 w-3 spinner-svg" viewBox="0 0 24 24">
                        <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
                          <circle cx="11" cy="11" r="11"></circle>
                          <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
                        </g>
                      </svg>`;e.currentTarget.innerHTML=e.currentTarget.innerHTML+"&nbsp;"+t}};var Pe={};o(Pe,{default:()=>ke});var ke=class extends i{static targets=["downIcon","upIcon","subMenu"];connect(){this.highlightMenuElement()}highlightMenuElement(){let e=this.element.querySelectorAll("a");Array.from(e).forEach(t=>{t.pathname==location.pathname&&(t.classList.add("active"),this.toggleSubMenu())})}toggleSubMenu(){this.subMenuTarget.style.display=="none"?(this.subMenuTarget.style.display="",this.downIconTarget.style.display="none",this.upIconTarget.style.display=""):(this.subMenuTarget.style.display="none",this.downIconTarget.style.display="",this.upIconTarget.style.display="none")}};var Ne={};o(Ne,{default:()=>je});var je=class extends i{static targets=["errorDiv","errorMessage"];perform(e){var t=e.currentTarget;t.value.length<t.minLength?(this.errorMessageTarget.innerText="Should be minimum "+t.minLength+" characters.",t.style.borderColor="#ef4444",this.errorDivTarget.classList.remove("hidden"),t.dataset.valid="false"):(this.errorMessageTarget.innerText="",t.style.removeProperty("border"),this.errorDivTarget.classList.add("hidden"),t.dataset.valid="true")}};var Re={};o(Re,{default:()=>De});var De=class extends i{static targets=["contentTable","loadMoreBtn","loadMoreBtnName","loadedCount","totalCount"];static values={date:{type:String},page:{type:Number}};initialize(){this.page=1,this.date=moment().format("DD/MM/YYYY")}loadResults(e){this.loadMoreBtnTarget.disabled=!0,this.loadMoreBtnNameTarget.innerHTML=this.spinner()+"Loading...",this.page=this.page+1;var t=e.currentTarget.dataset.url+"&page="+this.page;fetch(t).then(r=>r.text()).then(r=>this.processResponse(r))}processResponse(e){this.contentTableTarget.innerHTML=this.contentTableTarget.innerHTML+e,this.scrollToBottom();var t=this.setLoadedCount();this.updateLoadMore(t)}updateLoadMore(e){var t=parseInt(this.totalCountTarget.innerHTML);this.loadMoreBtnNameTarget.innerText="Load more",e>=t?(this.loadMoreBtnTarget.disabled=!0,this.loadMoreBtnTarget.style.background="gray"):this.loadMoreBtnTarget.disabled=!1}setLoadedCount(){var e=this.contentTableTarget.getElementsByTagName("tbody").length;return this.loadedCountTarget.innerHTML=e,e}scrollToBottom(){document.getElementsByTagName("html")[0].style.scrollBehavior="smooth",window.scrollTo(0,document.body.scrollHeight)}spinner(){return`
      <svg class="h-3 w-3 mr-1 text-white spinner-svg" viewBox="0 0 24 24">
        <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
          <circle cx="11" cy="11" r="11"></circle>
          <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
        </g>
      </svg>
    `}};var Fe={};o(Fe,{default:()=>Oe});var Oe=class extends i{static targets=["popup","title","body","container"];close(){this.bodyTarget.innerHTML=this.loadingIconHtml(),this.popupTarget.classList.add("hidden")}show(e){this.setTitle(e),this.setSize(e),this.popupTarget.classList.remove("hidden");var t=e.currentTarget.dataset.url;this.loadData(t)}setTitle(e){this.titleTarget.innerText=e.currentTarget.dataset.popupTitle}setSize(e){var t=e.currentTarget.dataset.sizeClass;t&&this.containerTarget.classList.add(t)}loadData(e){fetch(e).then(t=>t.text()).then(t=>this.bodyTarget.innerHTML=t)}loadingIconHtml(){return`
      <div class="flex items-center justify-center" style="min-height:400px;">
        <div class="p-8 max-w-md">
          <div class="flex items-center justify-center mb-3">
          <svg class="h-6 w-6 text-blue-600 spinner-svg" viewBox="0 0 24 24">
            <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
              <circle cx="11" cy="11" r="11"></circle>
              <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
            </g>
          </svg>

          </div>
          <div class="text-sm text-gray-700 mb-3 font-medium">
          Loading...
          </div>
        </div>
      </div>`}};var Ve={};o(Ve,{default:()=>He});var He=class extends i{static targets=["bodyContainer","tabList","defaultTab"];connect(){this.hasDefaultTabTarget&&this.loadDefaultTab()}setTabActive(e){let t=this.tabListTarget.getElementsByTagName("button");var r;for(r=0;r<t.length;r++)t[r].classList.remove("active-tab");e.currentTarget.classList.add("active-tab")}loadTab(e){this.setLoader(),this.setTabActive(e);var t=e.currentTarget.dataset.tabUrl;fetch(t).then(r=>r.text()).then(r=>this.bodyContainerTarget.innerHTML=r)}loadDefaultTab(){this.setLoader();var e=this.defaultTabTarget.dataset.tabUrl;fetch(e).then(t=>t.text()).then(t=>this.bodyContainerTarget.innerHTML=t)}setLoader(){this.bodyContainerTarget.innerHTML=`<div class="flex items-center justify-center" style="min-height:350px;">
                                            <div class="p-12 max-w-md">
                                              <div class="flex items-center justify-center mb-3">
                                                <svg class="h-6 w-6 text-blue-600 spinner-svg" viewBox="0 0 24 24">
                                                  <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
                                                    <circle cx="11" cy="11" r="11"></circle>
                                                    <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
                                                  </g>
                                                </svg>
                                              </div>
                                            <div class="text-sm text-gray-700 mb-3 font-medium">
                                              Loading...
                                            </div>
                                            </div>
                                          </div>`}};var $e={};o($e,{default:()=>Ue});function p(e){var{symbol:t,integerPart:r,decimalPart:n}=ti(e);if(r.length<=3)return Sn(e,t,r,n);let s=r.slice(-3),a=r.slice(0,-3),c=`${ri(a)},${s}`;return Sn(e,t,c,n)}function ti(e){let t="",r="",n="";return(e.includes("<")||e.includes(">"))&&(t=e[0],e=e.slice(1),e.replace(">","").replace("<","")),e.includes(".")?[r,n]=e.split("."):r=e,{symbol:t,integerPart:r,decimalPart:n}}function Sn(e,t,r,n){return e.includes(".")?`${t}${r}.${n}`:`${t}${r}`}function ri(e){return e.length<3?e:ni(e).join(",")}function ni(e){let t=[];e.length%2!==0&&(t.push(e[0]),e=e.substring(1));for(let r=0;r<e.length;r+=2)t.push(e.slice(r,r+2));return t}var Ue=class extends i{static targets=[""];readObx(e,t){let r=JSON.parse(this.element.dataset.loincValueMap);if(r[e])return this.transformForUnit(e,r[e].value,t)}transformForUnit(e,t,r){if(r===null)return t;switch(e){case"6690-2":return(parseFloat(t)*1e3).toString();case"777-3":return r.indexOf("lakh")>-1?(parseFloat(t)/100).toString():(parseFloat(t)*1e3).toString();default:return t}}insertValues(){confirm("Are you sure?")&&(document.querySelectorAll("input[data-loinc-code]").forEach(t=>{let r=t.getAttribute("data-loinc-code"),n=t.getAttribute("data-unit-name"),s=this.readObx(r,n);s&&(t.value=p(s))}),this.highlightAbnormals())}highlightAbnormals(){$(".numeric-test-result").each(function(){$(this).val()&&$(this).trigger("change")})}};var qe={};o(qe,{default:()=>ze});var ze=class extends i{static targets=["openModal"];open(){var e=$("#ls-modal"),t=this.openModalTarget.dataset.modalSize;e.addClass(t),e.foundation("open");var r=this.openModalTarget.dataset.link;$.get(r,function(n){var s=e.children("#ls-modal-content-area");s.html(n)})}};var Ye={};o(Ye,{default:()=>We});var We=class extends i{static targets=["patientFormDiv","newDoctorBtn","selectDoctor","selectCaseTypeBtn","selectInvestigationBox","newRatelistEntryBtn","ratelistShortcutLink","billingInfoDiv"];connect(){b("newCaseIntroComplete",this.element.dataset.introjsState)||this.startIntro()}restartIntro(){this.startIntro()}startIntro(){introJs().setOptions({steps:[{intro:"Please complete the intro to continue!"},{element:this.patientFormDivTarget,title:"Enter patient details",intro:"Enter all the patient details required as mentioned.",position:"bottom"},{element:this.newDoctorBtnTarget,title:"Add referral doctor",intro:"New referral doctors can be added from here."},{element:this.selectDoctorTarget,title:"Select referral doctor",intro:"Search and select the referral doctor from the drop down."},{element:this.selectCaseTypeBtnTarget,title:"Select case type to add investigations",intro:"Click to select the case type you would like to add the investigations for."},{element:this.billingInfoDivTarget,title:"Billing information & discount addition",intro:"Add discounts and amount received. Remaining, if any, will be marked as due. You can also select the transaction mode."}]}).oncomplete(this.markIntroComplete).start()}markIntroComplete(){T("newCaseIntroComplete")}};var Ke={};o(Ke,{default:()=>Je});var Je=class extends i{static targets=["inWordsEditable","inWordsInput","inWordsDisplay","editButton","deleteButton","lowerValue","upperValue"];edit(){this.inWordsEditableTarget.classList.remove("hidden"),this.inWordsDisplayTarget.classList.add("hidden"),this.editButtonTarget.classList.add("hidden"),this.deleteButtonTarget.classList.remove("hidden")}delete(){this.inWordsInputTarget.value="",this.updateDisplay(),this.inWordsEditableTarget.classList.add("hidden"),this.inWordsDisplayTarget.classList.remove("hidden"),this.editButtonTarget.classList.remove("hidden"),this.deleteButtonTarget.classList.add("hidden")}updateDisplay(){var e=parseFloat(this.lowerValueTarget.value).toLocaleString("en-IN"),t=parseFloat(this.upperValueTarget.value).toLocaleString("en-IN"),r=`${this.handleNan(e)} - ${this.handleNan(t)}`;this.inWordsDisplayTarget.innerText=r}handleNan(e){return e==="NaN"?"":e}};var Qe={};o(Qe,{default:()=>Ge});var Ge=class extends i{static targets=["numericRangeForm","textForm"];selectForm(e){var t=e.currentTarget.selectedOptions[0].value;t=="text"?(this.textFormTarget.classList.remove("hidden"),this.numericRangeFormTarget.classList.add("hidden")):t=="numeric_range"&&(this.textFormTarget.classList.add("hidden"),this.numericRangeFormTarget.classList.remove("hidden"))}};var Ze={};o(Ze,{default:()=>Xe});var Xe=class extends i{static targets=["notesRow","notesInput","addNotesBtn","remarksRow","remarksInput","addRemarksBtn","adviceRow","adviceInput","addAdviceBtn"];addNotes(e){this.notesRowTarget.classList.remove("hidden"),this.addNotesBtnTarget.classList.add("hidden")}removeNotes(){(this.notesInputTarget.value==""||confirm("Are you sure?"))&&(this.notesInputTarget.value="",this.notesRowTarget.classList.add("hidden"),this.addNotesBtnTarget.classList.remove("hidden"))}addRemarks(e){this.remarksRowTarget.classList.remove("hidden"),this.addRemarksBtnTarget.classList.add("hidden")}removeRemarks(){(this.remarksInputTarget.value==""||confirm("Are you sure?"))&&(this.remarksInputTarget.value="",this.remarksRowTarget.classList.add("hidden"),this.addRemarksBtnTarget.classList.remove("hidden"))}addAdvice(e){this.adviceRowTarget.classList.remove("hidden"),this.addAdviceBtnTarget.classList.add("hidden")}removeAdvice(){(this.adviceInputTarget.value==""||confirm("Are you sure?"))&&(this.adviceInputTarget.value="",this.adviceRowTarget.classList.add("hidden"),this.addAdviceBtnTarget.classList.remove("hidden"))}};var tt={};o(tt,{default:()=>et});var et=class extends i{static targets=[];initialize(){this.loaded=!1}load(){if(!this.loaded){var e=$("#lab_identifier").val();$.get("/"+e+"/notifications",function(t){$("#notifications-body").html(t)}),this.loaded=!0}}};var nt={};o(nt,{default:()=>rt});var rt=class extends i{static targets=["alert"];initialize(){let t="alert"+this.alertTarget.dataset.alertId;localStorage.getItem(t)||this.alertTarget.classList.remove("hidden")}close(){let t="alert"+this.alertTarget.dataset.alertId;localStorage.setItem(t,!0),this.alertTarget.classList.add("hidden")}};var st={};o(st,{default:()=>it});var it=class extends i{static targets=[];connect(){}add(e){e.preventDefault();var t=e.currentTarget.dataset.showBlock,r=document.querySelectorAll(`[data-block='${t}']`)[0];r.classList.remove("hidden"),e.currentTarget.parentElement.classList.add("hidden")}remove(e){e.preventDefault();var t=e.currentTarget.dataset.removeInputName,r=document.querySelectorAll(`[data-input='${t}']`)[0];r.value="";var n=e.currentTarget.dataset.hideBlock,s=document.querySelectorAll(`[data-block='${n}']`)[0];s.classList.add("hidden");var a=e.currentTarget.dataset.showBtn,d=document.querySelectorAll(`[data-btn='${a}']`)[0];d.classList.remove("hidden")}};var ot={};o(ot,{default:()=>at});var at=class extends i{static targets=["interval"];connect(){var e=this.intervalTarget,t=parseInt(e.textContent),r=setInterval(function(){t--,e.textContent=t,t<=0&&(location.reload(),clearInterval(r))},1e3)}};var dt={};o(dt,{default:()=>lt});var lt=class extends i{static targets=["panelContent"];remove(e){e.preventDefault(),this.panelContentTargets.forEach(function(t){t.remove()})}};var ut={};o(ut,{default:()=>ct});var ct=class extends i{static targets=["bodyContainer"];panelIdValue(){return this.element.dataset.panelId}edit(e){this.insertSpinner(e);let t=this.element.dataset.editUrl;fetch(t).then(r=>r.text()).then(r=>this.bodyContainerTarget.innerHTML=r)}update(e){this.insertSpinner(e);let t=this.element.dataset.updateUrl;var r=JSON.stringify({interpretation:tinymce.get(`textarea-${this.panelIdValue()}-interpretation`).getContent()});fetch(t,{method:"PATCH",body:r,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(n=>{n.status==200?this.loadView():alert("Failed")})}loadView(){let e=this.element.dataset.viewUrl;fetch(e).then(t=>t.text()).then(t=>{tinymce.remove(`#textarea-${this.panelIdValue()}-interpretation`),this.bodyContainerTarget.innerHTML=t})}cancel(e){this.insertSpinner(e),this.loadView()}insertSpinner(e){var t=`<svg class="h-5 w-5 mr-2 spinner-svg" viewBox="0 0 24 24">
                  <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
                    <circle cx="11" cy="11" r="11"></circle>
                    <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
                  </g>
                </svg>`;e.currentTarget.innerHTML=t}};var mt={};o(mt,{default:()=>ht});var ht=class extends i{static targets=["panelId"];isValid(e){var t=!0,r=Object.keys(e);for(var n in r)if(e[r[n]]===""){alert("Values can't be blank."),t=!1;break}return t}add(e){var t={panel_id:this.panelIdTarget.value,note:tinymce.activeEditor.getContent()};if(this.isValid(t)){e.currentTarget.innerText="Adding...";var r=JSON.stringify(t),n=this.element.dataset.url;fetch(n,{method:"POST",body:r,headers:{"Content-Type":"application/json"}}).then(s=>this.postAddResponse(s))}}postAddResponse(e){e.status==200?e.text().then(t=>{document.getElementById("interpreation-table-body").innerHTML=t+document.getElementById("interpreation-table-body").innerHTML,document.getElementById("ls-popup-close-btn").click()}):alert("Failed to add.")}update(e){e.currentTarget.innerText="Saving...";var t=JSON.stringify({note:tinymce.activeEditor.getContent()}),r=this.element.dataset.url;fetch(r,{method:"PATCH",body:t,headers:{"Content-Type":"application/json"}}).then(n=>this.postResponse(n))}postResponse(e){e.status==200?e.json().then(t=>{document.getElementById("panel_interpreation_text_"+t.id).innerHTML=t.note,document.getElementById("ls-popup-close-btn").click()}):alert("Failed to save.")}};var ft={};o(ft,{default:()=>pt});var pt=class extends i{static targets=["hideButton","showButton"];connect(){}initialize(){}expand(){document.querySelectorAll(".hide-show").forEach(function(e){e.classList.remove("hidden")}),this.showButtonTarget.classList.add("hidden"),this.hideButtonTarget.classList.remove("hidden")}collapse(){document.querySelectorAll(".hide-show").forEach(function(e){e.classList.add("hidden")}),this.showButtonTarget.classList.remove("hidden"),this.hideButtonTarget.classList.add("hidden")}};var vt={};o(vt,{default:()=>gt});var gt=class extends i{static targets=["mobileNumberHint","mobileNumberValidCheck"];connect(){}initialize(){}validateMobileNumber(e){var t=e.currentTarget,r=t.value.length,n=t.minLength,s=t.maxLength;r>=n&&r<=s?(this.mobileNumberValidCheckTarget.classList.remove("hidden"),this.hideMobileNumberHint()):(this.mobileNumberValidCheckTarget.classList.add("hidden"),this.showMobileNumberHint())}showMobileNumberHint(){this.mobileNumberHintTarget.classList.remove("hidden")}hideMobileNumberHint(){this.mobileNumberHintTarget.classList.add("hidden")}};var bt={};o(bt,{default:()=>yt});var yt=class extends i{static targets=["editButton","content","form","textArea","updateButton"];openForm(){this.updateTextarea(),this.formTarget.classList.remove("hidden"),this.contentTarget.classList.add("hidden"),this.editButtonTarget.style="display: none"}updateTextarea(){var e=new Date().toLocaleDateString(),t=this.contentTarget.innerText;if(t.includes(e))this.textAreaTarget.value=t;else{if(t==="")var r=e+" - ";else var r=`
`+e+" - ";this.textAreaTarget.value=t+r}}closeForm(){this.formTarget.classList.add("hidden"),this.contentTarget.classList.remove("hidden"),this.editButtonTarget.style="display: block"}labIdentifier(){return this.element.dataset.labIdentifier}patientId(){return this.element.dataset.patientId}update(){var e="/"+this.labIdentifier()+"/patients/"+this.patientId(),t=JSON.stringify({patient:{history:this.textAreaTarget.value}});fetch(e,{method:"PATCH",body:t,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(r=>this.processResponse(r))}processResponse(e){e.status==200?e.json().then(t=>{this.updateContent(t),this.closeForm()}):alert("Failed to save, please try again.")}updateContent(e){this.contentTarget.innerText=e.history}};var xt={};o(xt,{default:()=>Tt});var Tt=class extends i{static targets=["input","updateButton","content","closeButton","spinner"];labIdentifier(){return document.getElementById("lab_identifier").value}receiptId(){return this.element.dataset.receiptId}showSpinner(){this.spinnerTarget.classList.remove("hidden")}hideSpinner(){this.spinnerTarget.classList.add("hidden")}hideUpdateButton(){this.updateButtonTarget.classList.add("hidden")}showUpdateButton(){this.updateButtonTarget.classList.remove("hidden")}changeContent(e){this.contentTarget.innerText=e.payment_mode}updatePaymentMode(){this.hideUpdateButton(),this.showSpinner();var e="/"+this.labIdentifier()+"/receipts/"+this.receiptId()+"/update_payment_mode",t=JSON.stringify({receipt:{payment_mode:this.inputTarget.value}});fetch(e,{method:"PATCH",body:t,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(r=>this.processResponse(r))}processResponse(e){e.status==200?e.json().then(t=>{this.changeContent(t),this.hideSpinner(),this.showUpdateButton(),this.closePaymentModeModal()}):alert("Failed to save, please try again.")}closePaymentModeModal(){this.closeButtonTarget.click()}};var Ct={};o(Ct,{default:()=>Lt});var Lt=class extends i{static targets=["paymentModeSplitContainer","downArrowIcon","upArrowIcon"];toggle(){this.paymentModeSplitContainerTarget.classList.toggle("hidden"),this.downArrowIconTarget.classList.toggle("hidden"),this.upArrowIconTarget.classList.toggle("hidden")}};var wt={};o(wt,{default:()=>_t});var _t=class extends i{static targets=["contentBodyContainer"];static values={tabName:{type:String}};initialize(){this.tabName="active"}connect(){this.setTabActive(),this.loadUsers()}setTabActive(){document.querySelectorAll("ul#tab-list li button").forEach(t=>{t.classList.remove("active"),t.dataset.tabName==this.tabName&&t.classList.add("active")})}setTabName(e){e.target.tagName==="SPAN"?this.tabName=e.target.parentElement.dataset.tabName:this.tabName=e.target.dataset.tabName}loadTab(e){this.setTabName(e),this.setTabActive(),this.loadUsers()}loadUsers(){this.setLoader();var e=document.getElementById("lab_identifier").value,t="/"+e+"/users/"+this.tabName+"_users";fetch(t).then(r=>r.text()).then(r=>this.contentBodyContainerTarget.innerHTML=r)}setLoader(){this.contentBodyContainerTarget.innerHTML=`<div class="flex items-center justify-center" style="min-height:350px;">
                                                    <div class="p-12 max-w-md">
                                                      <div class="flex items-center justify-center mb-3">
                                                        <svg class="h-6 w-6 text-blue-600 spinner-svg" viewBox="0 0 24 24">
                                                          <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
                                                            <circle cx="11" cy="11" r="11"></circle>
                                                            <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
                                                          </g>
                                                        </svg>
                                                      </div>
                                                    <div class="text-sm text-gray-700 mb-3 font-medium">
                                                      Loading...
                                                    </div>
                                                    </div>
                                                  </div>`}};var Bt={};o(Bt,{default:()=>It});var It=class extends i{static targets=["spinnerContainer","urlButton","sendReportButton","pdfIconContainer"];static values={attemptsRemaining:{type:Number}};initialize(){this.attemptsRemaining=4}urlValue(){return this.urlButtonTarget.dataset.urlValue}connect(){this.hasSpinnerContainerTarget&&this.load()}delay(e){return new Promise(t=>setTimeout(t,e))}load(){this.sendReportButtonTarget.classList.add("pointer-events-none","cursor-not-allowed","opacity-50"),fetch(this.urlValue()).then(e=>e.json()).then(e=>this.processResponseJson(e))}processResponseJson(e){e.url!==null?(this.spinnerContainerTarget.remove(),this.urlButtonTarget.href=e.url,this.urlButtonTarget.classList.remove("primary-btn-disabled"),this.sendReportButtonTarget.classList.remove("pointer-events-none","cursor-not-allowed","opacity-50"),this.pdfIconContainerTarget.classList.remove("hidden")):(this.attemptsRemaining=this.attemptsRemaining-1,this.attemptsRemaining>0?this.delay(3e3).then(()=>this.load()):alert("Sorry, failed to load PDF. Please contact support by raising a support ticket."))}};var Et={};o(Et,{default:()=>At});var At=class extends i{static targets=["inputBox","list"];setInputBoxValue(e){var t=e.currentTarget.firstElementChild.firstElementChild.dataset.value;this.inputBoxTarget.value=t,this.hilightRow(e)}hilightRow(e){e.currentTarget.innerText.endsWith("Abnormal")?(this.inputBoxTarget.style.fontWeight="bold",this.inputBoxTarget.closest("tr").style.fontWeight="bold"):(this.inputBoxTarget.style.fontWeight="",this.inputBoxTarget.closest("tr").style.fontWeight="")}filter(){var e=this.inputBoxTarget.value.toLowerCase();if(e.length===0)this.showAllRows();else{var t=this.listTarget.getElementsByTagName("li"),r;for(r=0;r<t.length;r++){var n=t[r].firstElementChild.firstElementChild.innerText.trim().toLowerCase();n.indexOf(e)>-1?t[r].style.display="":t[r].style.display="none"}}}showAllRows(){var e=this.listTarget.getElementsByTagName("li"),t;for(t=0;t<e.length;t++)e[t].style.display=""}};var Mt={};o(Mt,{default:()=>St});var St=class extends i{static targets=["body","nameField","abnormalField","addBtn"];cancel(){this.addBtnTarget.classList.remove("hidden"),this.bodyTarget.remove()}add(){this.addBtnTarget.classList.add("hidden"),this.element.insertAdjacentHTML("afterbegin",this.createTemplate())}createTemplate(){return`<div class="px-4 py-3 -mx-2 -my-2 rounded-b-md bg-slate-50" data-target="possible-values-create.body">
                <div class="mb-4">
                  <input class="border-gray-300 h-8 block text-sm w-full shadow-sm p-2 text-slate-700 rounded-md font-medium focus:border-blue-500 focus:ring-blue-500" data-target="possible-values-create.nameField" type="text">
                </div>
                <div class="mb-3">
                  <div class="inline-flex items-center">
                    <input class="mb-0 mr-2 bg-white appearance-none w-4 h-4 border border-gray-300 rounded text-blue-500 focus:ring-blue-500 shadow-sm flex-shrink-0" data-target="possible-values-create.abnormalField" type="checkbox" >
                    <div>
                      <div class="text-gray-700 text-sm inline-flex font-medium items-center">
                        Abnormal
                      </div>
                    </div>
                  </div>
                </div>
                <button class="primary-btn-es font-semibold focus:ring-blue-500" data-action="possible-values-create#create" type="button">
                  Save
                </button>
                <button class="white-btn-es font-semibold focus:ring-blue-500" data-action="possible-values-create#cancel" type="button">
                  Cancel
                </button>
              </div>`}create(e){var t={name:this.nameFieldTarget.value,abnormal:this.abnormalFieldTarget.checked,lab_test_field_id:this.element.dataset.labTestFieldId};if(this.isValid(t)){e.currentTarget.innerText="Saving...";var r=JSON.stringify(t),n=this.element.dataset.url,s=this;fetch(n,{method:"POST",body:r,headers:{"Content-Type":"application/json"}}).then(a=>this.postCreateResponse(a,s))}}postCreateResponse(e,t){e.status==200?e.text().then(r=>{var n=t.element.previousElementSibling;n.insertAdjacentHTML("beforeend",r),n.scrollTop=n.scrollHeight,t.addBtnTarget.classList.remove("hidden"),t.bodyTarget.remove()}):alert("Failed to save.")}isValid(e){return!0}};var Pt={};o(Pt,{default:()=>kt});var kt=class extends i{static targets=["body","delete"];cancel(){this.bodyTarget.remove()}showOptions(e){var t=e.currentTarget.closest("li");t.insertAdjacentHTML("beforeend",this.deleteTemplate())}deleteTemplate(){return`<div class="px-4 py-3 bg-slate-50 border-t border-b border-gray-200" data-target="possible-values-delete.body">
                <div class="mb-3">
                  <div class="text-gray-700 text-sm inline-flex font-medium items-center">
                    Are you sure?
                  </div>
                </div>
                <div class="inline-flex items-center gap-2">
                  <button class="white-btn-es text-red-600 hover:text-red-700 font-semibold focus:ring-red-500 h-8" type="button" data-action="possible-values-delete#delete">
                    Delete
                  </button>
                  <button class="white-btn-es font-semibold focus:ring-blue-500 h-8" type="button" data-action="possible-values-delete#cancel">
                    Cancel
                  </button>
                </div>
              </div>`}delete(e){e.currentTarget.innerText="Deleting...";var t=this.element.dataset.url;fetch(t,{method:"DELETE",body:"",headers:{"Content-Type":"application/json"}}).then(r=>this.postDeleteResponse(r))}postDeleteResponse(e){e.status==200?e.json().then(t=>{t.success===1&&this.bodyTarget.closest("li").remove()}):alert("Failed to save.")}};var Nt={};o(Nt,{default:()=>jt});var jt=class extends i{static targets=["body","nameField","abnormalField","name","abnormal"];cancel(){this.bodyTarget.closest("li").children[1].classList.remove("hidden"),this.bodyTarget.remove()}edit(e){var t=e.currentTarget.closest("li");t.insertAdjacentHTML("afterbegin",this.editFormTemplate()),t.children[1].classList.add("hidden")}editFormTemplate(){var e=this.nameTarget.dataset.value,t="";return this.abnormalTarget.dataset.value==="true"&&(t="checked"),`<div class="px-4 py-3 border-t border-b border-gray-200 bg-slate-50" data-target="possible-values-update.body">
                <div class="mb-4">
                  <input value="${e}" class="border-gray-300 h-8 block text-sm w-full shadow-sm p-2 text-slate-700 rounded-md font-medium focus:border-blue-500 focus:ring-blue-500" data-target="possible-values-update.nameField" type="text">
                </div>
                <div class="mb-3">
                  <div class="inline-flex items-center">
                    <input ${t} class="mb-0 mr-2 bg-white appearance-none w-4 h-4 border border-gray-300 rounded text-blue-500 focus:ring-blue-500 shadow-sm flex-shrink-0" data-target="possible-values-update.abnormalField" type="checkbox" >
                    <div>
                      <div class="text-gray-700 text-sm inline-flex font-medium items-center">
                        Abnormal
                      </div>
                    </div>
                  </div>
                </div>
                <button class="primary-btn-es font-semibold focus:ring-blue-500" data-action="possible-values-update#update" type="button">
                  Save
                </button>
                <button class="white-btn-es font-semibold focus:ring-blue-500" data-action="possible-values-update#cancel" type="button">
                  Cancel
                </button>
              </div>`}update(e){var t={name:this.nameFieldTarget.value,abnormal:this.abnormalFieldTarget.checked};if(this.isValid(t)){e.currentTarget.innerText="Saving...";var r=JSON.stringify(t),n=this.element.dataset.url;fetch(n,{method:"PATCH",body:r,headers:{"Content-Type":"application/json"}}).then(s=>this.postUpdateResponse(s))}}postUpdateResponse(e){e.status==200?e.json().then(t=>{this.nameTarget.innerText=t.name,this.nameTarget.dataset.value=t.name,this.abnormalTarget.dataset.value=t.abnormal,t.abnormal==="true"?this.abnormalTarget.classList.remove("hidden"):this.abnormalTarget.classList.add("hidden"),this.bodyTarget.closest("li").children[1].classList.remove("hidden"),this.bodyTarget.remove()}):alert("Failed to save.")}isValid(e){return!0}};var Rt={};o(Rt,{default:()=>Dt});var Dt=class extends i{static targets=[];static values={businessType:{type:String},duration:{type:Number},billingOnly:{type:Boolean},currentPaymentPlanId:null};initialize(){this.businessTypeValue="pathology",this.durationValue=6,this.billingOnlyValue=!1}setCurrentPlan(){this.element.dataset.currentPaymentPlanId&&(this.businessTypeValue=this.element.dataset.businessType,this.durationValue=this.element.dataset.duration,this.currentPaymentPlanId=this.element.dataset.currentPaymentPlanId)}loadPricing(){var e={current_payment_plan_id:this.currentPaymentPlanId,frequency_in_months:this.durationValue,billing_only:this.billingOnlyValue,business_type:this.businessTypeValue,under_trial:this.element.dataset.underTrial};$.get("/pricing_table",e,function(t){$(".plan-details").html(t);var r=$("#button-endpoint").val(),n=$("#button-method").val(),s=$("#button-label").val();document.querySelectorAll(".select-plan-button").forEach(function(a){a.dataset.method=n,a.href=r+a.dataset.paymentPlanId,a.text=s})}),this.setActive()}setActive(){$(".payment-plan-business-types-selector a").removeClass("active"),$(".payment-plan-business-types-selector a."+this.businessTypeValue).addClass("active"),$(".plan-duration").removeClass("active"),$(".plan-duration."+this.durationValue).addClass("active")}connect(){this.setCurrentPlan(),this.loadPricing()}updateBusinessType(e){this.businessTypeValue=e.srcElement.dataset.businessType,this.loadPricing()}updateDuration(e){this.durationValue=e.srcElement.dataset.duration,this.loadPricing()}updateBillingOnly(e){e.preventDefault(),alert("Please select any plan for now and contact support to switch to billing only plans later.")}};var Ft={};o(Ft,{default:()=>Ot});var Ot=class extends i{static targets=["loadButton","formContent","spinner"];loadForm(){let e=this.loadButtonTarget.dataset.url;this.spinnerTarget.classList.remove("hidden"),fetch(e).then(t=>t.text()).then(t=>this.processResponse(t))}processResponse(e){this.formContentTarget.innerHTML=e,this.formContentTarget.classList.remove("hidden"),this.loadButtonTarget.classList.add("hidden"),this.spinnerTarget.classList.add("hidden")}cancel(){this.loadButtonTarget.classList.remove("hidden"),this.formContentTarget.classList.add("hidden")}};var Vt={};o(Vt,{default:()=>Ht});var Ht=class extends i{static targets=["printedLabel"];static values={status:String};initialize(){this.status=this.element.dataset.status}labIdentifier(){return document.getElementById("lab_identifier").value}modelName(){return this.element.dataset.modelName}modelId(){return this.element.dataset.modelId}markPrinted(){this.status!=="printed"&&fetch("/"+this.labIdentifier()+"/medical_reports/"+this.modelId()+"/mark_printed?model_name="+this.modelName()).then(this.showLabel()).then(this.status="printed")}markNotPrinted(){fetch("/"+this.labIdentifier()+"/medical_reports/"+this.modelId()+"/mark_not_printed?model_name="+this.modelName()).then(this.hideLabel()).then(this.status="not_printed")}showLabel(){this.printedLabelTarget.classList.remove("hidden")}hideLabel(){this.printedLabelTarget.classList.add("hidden")}};var $t={};o($t,{default:()=>Ut});var Ut=class extends i{static targets=["likeButton","likesCount"];save(e){this.likeButtonTarget.classList.toggle("bg-blue-100");var t=this.likeButtonTarget.dataset.url,r=this.likesCountTarget;$.post(t,function(n){r.innerText=n})}};var qt={};o(qt,{default:()=>zt});var zt=class extends i{static targets=["revenueShare","spinner","checkIcon","errorMsg","errorMsgContainer","originalValue"];clearEntryId(){this.revenueShareTarget.removeAttribute("data-entry-id")}saveOrDelete(){var e=this.revenueShareTarget.dataset.entryId;if(console.log("Entry id "+e),e!==void 0)if(this.revenueShareTarget.value){var t=this.revenueShareTarget.dataset.updateDeleteUrl;this.update(t)}else{var t=this.revenueShareTarget.dataset.updateDeleteUrl;this.delete(t)}else if(this.revenueShareTarget.value){console.log("Revenue share "+this.revenueShareTarget.value);var t=this.revenueShareTarget.dataset.createUrl;console.log("URL "+t),this.create(t)}}create(e){this.showSpinner(),this.hideCheckIcon();var t=this.revenueShareTarget.dataset,r=JSON.stringify({referrer_id:t.referrerId,investigation_id:t.investigationId,revenue_share:this.revenueShareTarget.value});fetch(e,{method:"POST",body:r,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(n=>this.processCreateUpdateResponse(n))}processCreateUpdateResponse(e){e.status==200?e.json().then(t=>{this.revenueShareTarget.dataset.updateDeleteUrl=t.updateDeleteUrl,this.revenueShareTarget.dataset.entryId=t.entryId,this.hideSpinner(),this.hideError(),this.showCheckIcon(),this.addStrikeThroughOriginalValue()}):e.json().then(t=>{this.hideSpinner(),this.showError(t.errors)})}update(e){this.showSpinner(),this.hideCheckIcon();var t=JSON.stringify({revenue_share:this.revenueShareTarget.value});fetch(e,{method:"PATCH",body:t,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(r=>this.processCreateUpdateResponse(r))}delete(e){confirm("Are you sure, you want to delete?")&&(this.showSpinner(),this.hideCheckIcon(),fetch(e,{method:"DELETE",body:"",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(t=>this.processDeleteResponse(t)))}processDeleteResponse(e){e.status==200?(this.revenueShareTarget.value="",this.hideSpinner(),this.showCheckIcon(),this.clearEntryId(),this.removeStrikeThroughOriginalValue()):alert("Failed to save, please try again or contact support.")}showSpinner(){this.spinnerTarget.classList.remove("hidden")}hideSpinner(){this.spinnerTarget.classList.add("hidden")}showCheckIcon(){this.checkIconTarget.classList.remove("hidden")}hideCheckIcon(){this.checkIconTarget.classList.add("hidden")}showError(e){this.errorMsgContainerTarget.classList.remove("hidden"),this.errorMsgTarget.innerText=e}hideError(){this.errorMsgContainerTarget.classList.add("hidden"),this.errorMsgTarget.innerText=""}addStrikeThroughOriginalValue(){this.originalValueTarget.classList.add("line-through")}removeStrikeThroughOriginalValue(){this.originalValueTarget.classList.remove("line-through")}};var Yt={};o(Yt,{default:()=>Wt});var Wt=class extends i{static targets=[];removeLetterhead(e){e.preventDefault();var t=confirm("Are you sure you want to remove this letterhead?");t==!0&&($('input[name="setting[remove_letterhead]"]').val("1"),$(".letterhead-thumbnail").remove(),this.element.remove())}removeLabInchargeSignature(e){e.preventDefault();var t=confirm("Are you sure you want to remove this signature?");t==!0&&($('input[name="setting[remove_lab_incharge_signature]"]').val("1"),$(".lab-incharge-signature").remove(),this.element.remove())}removeThirdSign(e){e.preventDefault();var t=confirm("Are you sure you want to remove this signature?");t==!0&&($('input[name="setting[remove_third_sign]"]').val("1"),$(".third-sign").remove(),this.element.remove())}removeFourthSign(e){e.preventDefault();var t=confirm("Are you sure you want to remove this signature?");t==!0&&($('input[name="setting[remove_fourth_sign]"]').val("1"),$(".fourth-sign").remove(),this.element.remove())}removeReportSignature(e){e.preventDefault();var t=confirm("Are you sure you want to remove this signature?");t==!0&&($('input[name="setting[remove_report_signature]"]').val("1"),$(".report-signature").remove(),this.element.remove())}removeDigitalXraySignature(e){e.preventDefault();var t=confirm("Are you sure you want to remove?");t==!0&&($('input[name="digital_xray_signature[remove_image]"]').val("1"),this.element.remove())}removeUsgSignature(e){e.preventDefault();var t=confirm("Are you sure you want to remove?");t==!0&&($('input[name="usg_signature[remove_image]"]').val("1"),this.element.remove())}};var Kt={};o(Kt,{default:()=>Jt});var Jt=class extends i{connect(){this.element.innerHTML="";let e=this.element.dataset.url,t=this.element.dataset.moduleSize;new QRCode(this.element,{text:e,colorDark:"#000000",colorLight:"#ffffff",width:100,height:100,useSVG:!0,moduleSize:t})}};var Qt={};o(Qt,{default:()=>Gt});var Gt=class extends i{static targets=["sidebarBox","sidebarBoxOverlay","sidebarTooltip","openIcon","closeIcon","reportContentWrapper","patientInfo","doctorInfo","patientHistory","previousReports","recentUsgReports"];static values={currentState:String};initialize(){this.currentState="close"}toggle(){this.toggleCurrentState(),this.toggleSidebar(),this.toggleTooltip(),this.toggleSidebarContent()}toggleCurrentState(){this.currentState==="close"?this.currentState="open":this.currentState="close"}toggleSidebarContent(){this.reportContentWrapperTarget.classList.toggle("mr-14"),this.reportContentWrapperTarget.classList.toggle("mr-64");var e=Array.from(document.getElementsByClassName("collapsed-sidebar-content")),t=this.currentState;e.forEach(function(r){t==="close"?r.style="display: hidden":r.style="display: block"})}collapseAll(){this.patientInfoTarget.style="display: none",this.doctorInfoTarget.style="display: none",this.patientHistoryTarget.style="display: none",this.previousReportsTarget.style="display: none",this.hasRecentUsgReportsTarget&&(this.recentUsgReportsTarget.style="display: none")}showPatientInfo(){this.collapseAll(),this.patientInfoTarget.style="display: block"}showDoctorInfo(){this.collapseAll(),this.doctorInfoTarget.style="display: block"}showPatientHistory(){this.collapseAll(),this.patientHistoryTarget.style="display: block"}showPreviousReports(){this.collapseAll(),this.previousReportsTarget.style="display: block"}showRecentUsgReports(){this.collapseAll(),this.recentUsgReportsTarget.style="display: block"}toggleSidebar(){this.sidebarBoxTarget.classList.toggle("lg:hidden"),this.sidebarBoxTarget.classList.toggle("lg:block"),this.sidebarBoxOverlayTarget.classList.toggle("lg:hidden"),this.sidebarBoxOverlayTarget.classList.toggle("lg:block"),this.openIconTarget.classList.toggle("hidden"),this.closeIconTarget.classList.toggle("hidden"),this.sidebarBoxTarget.classList.toggle("w-14"),this.sidebarBoxTarget.classList.toggle("w-60"),this.collapseAll()}toggleTooltip(){var e="Close sidebar";this.sidebarTooltipTarget.innerHTML==e?this.sidebarTooltipTarget.innerHTML="Open sidebar":this.sidebarTooltipTarget.innerHTML=e}};var Zt={};o(Zt,{default:()=>Xt});var Xt=class extends i{static targets=["errorDiv","errorMessage"];perform(e){var t=e.currentTarget,r=t.dataset.errorMessage;t.value.length===0?(this.errorMessageTarget.innerText=r,t.style.borderColor="#ef4444",this.errorDivTarget.classList.remove("hidden"),t.dataset.valid="false"):(this.errorMessageTarget.innerText="",t.style.removeProperty("border"),this.errorDivTarget.classList.add("hidden"),t.dataset.valid="true")}};var tr={};o(tr,{default:()=>er});var er=class extends i{static targets=["resendBtn","countdownDiv","countdownValue"];static values={seconds:Number};connect(){this.startCountdown()}perform(e){this.startCountdown();var t=e.target.dataset.url;fetch(t)}startCountdown(){this.seconds=10;var e=setInterval(()=>{this.seconds--,this.countdownValueTarget.innerHTML=this.seconds,this.resendBtnTarget.classList.add("hidden"),this.countdownDivTarget.classList.remove("hidden"),this.seconds<=0&&(clearInterval(e),this.resendBtnTarget.classList.remove("hidden"),this.countdownDivTarget.classList.add("hidden"),this.seconds=10)},1e3)}};var nr={};o(nr,{default:()=>rr});var rr=class extends i{toggle_archive(e){e.preventDefault();var t=e.currentTarget.closest("tr"),r=e.currentTarget.dataset.url;e.currentTarget.innerText="Please wait...",fetch(r,{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(n=>n.json()).then(n=>this.processResponseJson(n,t))}processResponseJson(e,t){this.resetStats(e),t.remove()}resetStats(e){document.getElementById("active-sample-collectors-count").innerText=e.active,document.getElementById("archived-sample-collectors-count").innerText=e.archived}};var sr={};o(sr,{default:()=>ir});var ir=class extends i{static targets=[];connect(){window.onscroll=this.showHideScrollBtn}disconnect(){window.onscroll=null}scroll(){document.getElementsByTagName("html")[0].style.scrollBehavior="smooth",document.body.scrollTop=0,document.documentElement.scrollTop=0}showHideScrollBtn(){document.body.scrollTop>20||document.documentElement.scrollTop>20?document.getElementById("scrollToTopBtn").style.display="block":document.getElementById("scrollToTopBtn").style.display="none"}};var or={};o(or,{default:()=>ar});var ar=class extends i{static targets=[""];bringFocus(){setTimeout(function(){document.getElementById("searchInput").focus()},400)}};var dr={};o(dr,{default:()=>lr});var lr=class extends i{static targets=["input","body","searchByBtn","durationBtn"];static values={typingTimer:Number,doneTypingInterval:Number};initialize(){this.doneTypingInterval=800,this.searchBy="name",this.duration="last_7_days",this.page=1}updateSearchBy(e){var t=e.currentTarget.value;t.length==1&&this.searchBy==="name"&&!isNaN(t)&&(this.searchBy="mobile_number",this.deselectSearchBy(),this.searchByBtnTargets[2].classList.add("active"),this.duration="all",this.deselectDuration(),this.durationBtnTargets[3].classList.add("active"))}clickOutside(){this.clear()}deselectSearchBy(){this.searchByBtnTargets.forEach(e=>{e.classList.remove("active")})}deselectDuration(){this.durationBtnTargets.forEach(e=>{e.classList.remove("active")})}setSearchBy(e){switch(this.page=1,this.deselectSearchBy(),e.currentTarget.innerText){case"Reg. no":this.searchBy="reg_no",this.setDurationAll();break;case"Name":this.searchBy="name";break;case"Mobile number":this.searchBy="mobile_number",this.setDurationAll();break;case"UHID":this.searchBy="uhid",this.setDurationAll();break}e.currentTarget.classList.add("active"),this.doneTypingLoadResults(),this.inputTarget.focus()}setDurationAll(){this.duration="all",this.deselectDuration(),this.durationBtnTargets[3].classList.add("active")}setDuration(e){switch(this.deselectDuration(),e.currentTarget.innerText){case"Last 7 days":this.duration="last_7_days";break;case"Last 30 days":this.duration="last_30_days";break;case"Last 90 days":this.duration="last_90_days";break;case"All":this.duration="all";break}e.currentTarget.classList.add("active"),this.doneTypingLoadResults()}checkAndLoad(){clearTimeout(this.typingTimer),this.typingTimer=setTimeout(this.doneTypingLoadResults.bind(this),this.doneTypingInterval)}doneTypingLoadResults(){this.inputTarget.value.length>2?this.loadResults():console.log("Not loading results")}next(){this.page=this.page+1,this.doneTypingLoadResults()}prev(){this.page=this.page-1,this.doneTypingLoadResults()}clear(){this.insertEmptyState(),this.inputTarget.value="",this.searchBy="name",this.duration="last_7_days",this.page=1,this.restoreDefaultSelection()}restoreDefaultSelection(){this.deselectDuration(),this.deselectSearchBy(),this.durationBtnTargets[0].classList.add("active"),this.searchByBtnTargets[1].classList.add("active")}loadResults(){this.insertLoader();var e=document.getElementById("lab_identifier").value,t=`/${e}/search/load_results?q=${this.inputTarget.value}&search_by=${this.searchBy}&duration=${this.duration}&page=${this.page}`;fetch(t).then(r=>r.text()).then(r=>this.bodyTarget.innerHTML=r)}insertEmptyState(){var e=`<div class="flex justify-center py-20">
                           <div class="flex flex-col">
                             <div class="w-10 h-10 bg-slate-100 rounded-md flex items-center justify-center mx-auto mb-4">
                               <svg class="h-6 w-6 text-slate-400" aria-hidden="true" fill="none" height="24" width="24">
                                 <path d="m19 19-3.5-3.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
                                 <circle cx="11" cy="11" r="6" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></circle>
                               </svg>
                             </div>
                             <div class="text-center text-base text-slate-700 font-medium mb-2">
                               Enter the search keyword.
                             </div>
                           </div>
                         </div>`;this.bodyTarget.innerHTML=e}insertLoader(){var e=`<div class="flex justify-center py-20">
                       <div class="mb-2">
                         <div class="flex justify-center mb-1">
                         <svg class="h-5 w-5 mr-2 text-blue-600 spinner-svg" viewBox="0 0 24 24">
                           <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
                             <circle cx="11" cy="11" r="11"></circle>
                             <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
                           </g>
                         </svg>
                       </div>
                       <div class="flex justify-center">
                         <div class="text-sm font-medium text-gray-600">Loading results...</div>
                         </div>
                       </div>
                     </div>`;this.bodyTarget.innerHTML=e}};var ur={};o(ur,{default:()=>cr});var cr=class extends i{static targets=["showMoreButton","hideMoreButton"];showMore(){this.showMoreButtonTarget.classList.add("hidden"),this.hideMoreButtonTarget.classList.remove("hidden"),Array.from(document.getElementsByClassName("more-filter-options")).forEach(function(e){e.style.display="block"})}hideMore(){this.showMoreButtonTarget.classList.remove("hidden"),this.hideMoreButtonTarget.classList.add("hidden"),Array.from(document.getElementsByClassName("more-filter-options")).forEach(function(e){e.style.display="none"})}};var mr={};o(mr,{default:()=>hr});var hr=class extends i{static targets=["searchTermInput","clearSearchButton","dataList"];clearSearch(){this.searchTermInputTarget.value="",this.clearSearchButtonTarget.parentElement.classList.add("hidden"),this.showAllRows()}search(){var e=this.searchTermInputTarget.value.toLowerCase();if(e.length===0)this.clearSearch();else{this.clearSearchButtonTarget.parentElement.classList.remove("hidden");var t=this.dataListTarget.getElementsByTagName("li"),r;for(r=0;r<t.length;r++){var n=t[r].innerText.toLowerCase();n.indexOf(e)>-1?t[r].style.display="":t[r].style.display="none"}}}showAllRows(){var e=this.dataListTarget.getElementsByTagName("li"),t;for(t=0;t<e.length;t++)e[t].style.display=""}};var fr={};o(fr,{default:()=>pr});var pr=class extends i{static targets=["searchTermInput","clearSearchButton","dataTable","searchTargetBody"];clearSearch(){this.searchTermInputTarget.value="",this.clearSearchButtonTarget.parentElement.classList.add("hidden"),this.showAllRows()}search(){var e=this.searchTermInputTarget.value.toLowerCase();if(e.length===0)this.clearSearch();else{if(this.clearSearchButtonTarget.parentElement.classList.remove("hidden"),this.hasSearchTargetBodyTarget)var t=this.dataTableTarget.getElementsByTagName("tbody");else var t=this.dataTableTarget.getElementsByTagName("tr");var r;for(r=1;r<t.length;r++){var n=t[r].innerText.toLowerCase();n.indexOf(e)>-1?t[r].style.display="":t[r].style.display="none"}}}showAllRows(){var e=this.dataTableTarget.getElementsByTagName("tr"),t;for(t=0;t<e.length;t++)e[t].style.display=""}};var vr={};o(vr,{default:()=>gr});var gr=class extends i{static targets=["body","spinnerContainer"];initialize(){this.loading=!1}loadReports(){this.loading||(this.loading=!0,this.insertSpinner(),fetch(this.data.get("url")).then(e=>e.text()).then(e=>this.processResponseHTML(e)))}processResponseHTML(e){this.bodyTarget.innerHTML=this.bodyTarget.innerHTML+e,this.spinnerContainerTarget.innerHTML=""}insertSpinner(){var e=`<svg class="h-4 w-4 mr-2 spinner-svg" viewBox="0 0 24 24">
                  <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
                    <circle cx="11" cy="11" r="11"></circle>
                    <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
                  </g>
                </svg>`;this.spinnerContainerTarget.innerHTML=e}};var br={};o(br,{default:()=>yr});var yr=class extends i{static targets=["signedReports","spinner","waPatientBtn","emailPatientBtn","waDoctorBtn","emailDoctorBtn","smsPatientBtn","smsDoctorBtn","notificationBox","contactFormBox","contactInfo","downloadPdfButton","downloadSpinner"];static values={refreshInterval:Number,maxAttempts:Number};initialize(){this.refreshIntervalValue=3e3,this.maxAttempts=4}isMobile(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}whatsappBaseUrl(e){if(e=="app")return"https://api.whatsapp.com";if(e=="web")return"https://web.whatsapp.com"}postReferrerUpdate(e){e.error?this.showAlert(e.error):(this.showNotice("Doctor info updated. Try sending the report now."),e.contact_mobile_number&&(this.smsDoctorBtnTarget.dataset.mobile=e.contact_mobile_number,this.waDoctorBtnTarget.dataset.mobile=e.contact_mobile_number),e.contact_email&&(this.emailDoctorBtnTarget.dataset.email=e.contact_email))}updateReferrer(){if(this.contactInfoTarget.value===""||!this.contactInfoTarget.validity.valid){this.showAlert("Please enter a valid input.");return}var e=this.contactInfoTarget.name,t=this.contactInfoTarget.value,r=JSON.stringify({referrer:{[e]:t}});fetch("/"+this.labIdentifier()+"/referrers/"+this.referrerId(),{method:"PATCH",body:r,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(n=>n.json()).then(n=>this.postReferrerUpdate(n))}postPatientUpdate(e){e.error?this.showAlert(e.error):(this.showNotice("Patient info updated. Try sending the report now."),e.contact_mobile_number&&(this.smsPatientBtnTarget.dataset.mobile=e.contact_mobile_number,this.waPatientBtnTarget.dataset.mobile=e.contact_mobile_number),e.contact_email&&(this.emailPatientBtnTarget.dataset.email=e.contact_email))}updatePatient(){if(this.contactInfoTarget.value===""||!this.contactInfoTarget.validity.valid){this.showAlert("Please enter a valid input.");return}var e=this.contactInfoTarget.name,t=this.contactInfoTarget.value,r=JSON.stringify({patient:{[e]:t}});fetch("/"+this.labIdentifier()+"/patients/"+this.patientid(),{method:"PATCH",body:r,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(n=>n.json()).then(n=>this.postPatientUpdate(n))}loadContactForm(e,t,r){var n=this.element.dataset.minNationalNumberLength,s=this.element.dataset.maxNationalNumberLength,a=r==="contact_email"?"email":"tel",d=r==="contact_email"?"":`pattern=".{${n},${s}}"`,c=e==="patient"?"updatePatient":"updateReferrer",u=e==="patient"?"Patient":"Doctor",l=`<div class="my-4 max-w-md flex items-center">
                        <div class="relative">
                          <label class="text-sm text-gray-700">${u} ${t}</label>
                        </div>
                        <div class="flex-grow mx-2">
                          <input class="w-full mb-0 border border-gray-300 rounded-md px-3 py-2 text-gray-700 text-sm"
                                data-target="send-reports.contactInfo"
                                ${d}
                                name="${r}"
                                type="${a}">
                        </div>
                        <div class="relative">
                          <a class="primary-btn-sm" data-action="send-reports#${c}">Update</a>
                        </div>
                    </div>`;this.contactFormBoxTarget.innerHTML=l}labIdentifier(){return document.getElementById("lab_identifier").value}reportModel(){return this.element.dataset.modelName}reportId(){return this.element.dataset.modelId}patientid(){return this.element.dataset.patientId}referrerId(){return this.element.dataset.referrerId}urlValue(){return"/"+this.labIdentifier()+"/send_reports/report_pdf_urls?model_name="+this.reportModel()+"&model_id="+this.reportId()}removeSpinner(){this.spinnerTarget.remove()}loadIframes(e){e.forEach(this.loadIframe),this.checkIframesAndStopRefreshing()}checkIframesAndStopRefreshing(){this.pdfSrcMissing()||this.stopRefreshing()}loadIframe(e,t){let r=e.report_pdf_url,n=e.signed_pdf_url;if(r){var s=document.getElementById("report-iframe-"+t),a=document.getElementById("report-pdf-link-"+t),d=document.getElementById("report-signed-pdf-link-"+t),c=d.querySelector(".spinner");if(a.href=r,d.href=n,d.classList.remove("opacity-50","pointer-events-none"),c.classList.add("hidden"),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){var u="/pdfjs/minimal?file="+r;s.src=u}else s.src=r}}pdfSrcMissing(){let e=r=>r.getAttribute("src")==="";return Array.from(document.getElementsByClassName("report-pdf-iframe")).some(e)}connect(){this.hasSignedReportsTarget&&(this.pdfSrcMissing()&&this.startRefreshing(),this.makePdfViewerMobileCompatible())}makePdfViewerMobileCompatible(){this.isMobile()&&Array.from(document.getElementsByClassName("report-pdf-iframe")).forEach(function(e){var t=e.src;if(t!==""){var r="/pdfjs/minimal?file="+t;e.src=r}})}disconnect(){this.stopRefreshing()}disableDownloadButton(){this.downloadPdfButtonTargets.forEach((e,t)=>{e.classList.add("opacity-50","pointer-events-none")}),this.downloadSpinnerTargets.forEach(e=>{e.classList.remove("hidden")})}startRefreshing(){this.spinnerTarget.classList.remove("hidden"),this.disableDownloadButton(),setTimeout(()=>{this.loadPdfUrl()},1e3),this.refreshTimer=setInterval(()=>{this.maxAttempts=this.maxAttempts-1,this.maxAttempts>0&&this.loadPdfUrl(),this.maxAttempts==0&&(this.showAlert("Failed to load PDF. Please try again after some time or contact support."),this.removeSpinner())},this.refreshIntervalValue)}stopRefreshing(){this.refreshTimer&&(this.hasSpinnerTarget&&this.removeSpinner(),clearInterval(this.refreshTimer))}loadPdfUrl(){fetch(this.urlValue()).then(e=>e.json()).then(e=>this.loadIframes(e))}logMixpanelWhatsappEvent(e){fetch("/"+document.getElementById("lab_identifier").value+"/mixpanel_record_whatsapp_event?recipient="+e)}whatsAppPatient(e){if(!this.eligibleToSend())this.askToSwitchPlan();else{var t=this.waPatientBtnTarget.dataset.downloadReportUrl,r=this.waPatientBtnTarget.dataset.dialCode,n=this.waPatientBtnTarget.dataset.mobile,s=e.currentTarget.dataset.via,a=encodeURIComponent(this.waPatientBtnTarget.dataset.message).replace("REPORT_URL",t);if(n){this.logMixpanelWhatsappEvent("Patient");var d=this.whatsappBaseUrl(s)+"/send?phone="+r+n+"&text="+a;window.open(d,"_blank")}else this.showAlert("Patient mobile number not present. Please update and retry."),this.loadContactForm("patient","mobile number","contact_mobile_number")}}showAlert(e){var t=`<div class="my-4 bg-red-100 rounded-md p-4 flex text-sm text-red-700">
          <svg class="inline flex-shrink-0 h-5 w-5 mr-2 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
          </svg>
          <div>${e}</div>
        </div>`;this.notificationBoxTarget.innerHTML=t}showNotice(e){var t=`<div class="my-4 bg-green-100 rounded-md p-4 text-sm text-green-700 flex" data-target="send-reports.deliveryStatus">
                <svg class="inline flex-shrink-0 h-5 w-5 mr-2 text-green-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                </svg>
                ${e}
            </div>`;this.notificationBoxTarget.innerHTML=t}whatsAppDoctor(e){if(!this.eligibleToSend())this.askToSwitchPlan();else{var t=this.waDoctorBtnTarget.dataset.downloadReportUrl,r=this.waDoctorBtnTarget.dataset.dialCode,n=this.waDoctorBtnTarget.dataset.mobile,s=e.currentTarget.dataset.via,a=encodeURIComponent(this.waDoctorBtnTarget.dataset.message).replace("REPORT_URL",t);if(n){this.logMixpanelWhatsappEvent("Doctor");var d=this.whatsappBaseUrl(s)+"/send?phone="+r+n+"&text="+a;window.open(d,"_blank")}else this.showAlert("Doctor mobile number not present. Please update and retry."),this.loadContactForm("referrer","mobile number","contact_mobile_number")}}emailPatient(){if(!this.eligibleToSend())this.askToSwitchPlan();else{var e=this.emailPatientBtnTarget.dataset.email;if(e){var t={model_name:this.reportModel(),model_id:this.reportId()};this.showNotice("Sending email to the patient..."),fetch("/"+this.labIdentifier()+"/send_reports/email_patient",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(r=>r.json()).then(r=>{r.email_sent?this.showNotice(r.message):this.showAlert(r.message)})}else this.showAlert("Patient email not present. Please update and retry."),this.loadContactForm("patient","email","contact_email")}}emailDoctor(){if(!this.eligibleToSend())this.askToSwitchPlan();else{var e=this.emailDoctorBtnTarget.dataset.email;if(e){var t={model_name:this.reportModel(),model_id:this.reportId()};this.showNotice("Sending email to the doctor..."),fetch("/"+this.labIdentifier()+"/send_reports/email_doctor",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(r=>r.json()).then(r=>{r.email_sent?this.showNotice(r.message):this.showAlert(r.message)})}else this.showAlert("Doctor email not present. Please update and retry."),this.loadContactForm("referrer","email","contact_email")}}smsPatient(){if(!this.eligibleToSend())this.askToSwitchPlan();else{var e=this.smsPatientBtnTarget.dataset.mobile;if(e){var t={model_name:this.reportModel(),model_id:this.reportId()};this.showNotice("Sending sms to the patient..."),fetch("/"+this.labIdentifier()+"/send_reports/sms_patient",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(r=>r.json()).then(r=>{r.sms_sent?this.showNotice(r.message):this.showAlert(r.message)})}else this.showAlert("Patient mobile number not present. Please update and retry."),this.loadContactForm("patient","mobile number","contact_mobile_number")}}smsDoctor(){if(!this.eligibleToSend())this.askToSwitchPlan();else{var e=this.smsDoctorBtnTarget.dataset.mobile;if(e){var t={model_name:this.reportModel(),model_id:this.reportId()};this.showNotice("Sending sms to the doctor..."),fetch("/"+this.labIdentifier()+"/send_reports/sms_doctor",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(r=>r.json()).then(r=>{r.sms_sent?this.showNotice(r.message):this.showAlert(r.message)})}else this.showAlert("Doctor mobile number not present. Please update and retry."),this.loadContactForm("referrer","mobile number","contact_mobile_number")}}eligibleToSend(){return this.reportModel()=="LabCase"?!0:this.element.dataset.eligibility==="true"}askToUpgrade(){var e="/"+this.labIdentifier()+"/upgrade",t=`<div>This feature is not available in your current plan, please <a href=${e} target="_blank">upgrade</a> to use this feature. Contact support to know more.</div>`;this.showAlert(t)}askToChangePlan(){var e="/"+this.labIdentifier()+"/diagnostic_labs/change_plan",t=`<div>This feature is not available in your current plan, <a href=${e} target="_blank">change plan</a> to use this feature. Contact support to know more.</div>`;this.showAlert(t)}askToSwitchPlan(){this.element.dataset.underTrial==="true"?this.askToChangePlan():this.askToUpgrade()}};var xr={};o(xr,{default:()=>Tr});var Tr=class extends i{static targets=["invite_employee","centre_details","ratelist","letterhead","sms","case_reg_no","panels","proofread"];connect(){var e=document.getElementById("setup_hightlight");if(e!==null){var t=this.targets.find(e.value);t.classList.add("active")}}};var Cr={};o(Cr,{default:()=>Lr});var Lr=class extends i{static targets=["expandable"];toggleExpand(e){e.target.classList.toggle("fa-angle-down"),e.target.classList.toggle("fa-angle-right"),this.expandableTarget.classList.toggle("hide")}};var wr={};o(wr,{default:()=>_r});var _r=class extends i{static targets=["testId"];isValid(e){var t=!0,r=Object.keys(e);for(var n in r)if(e[r[n]]===""){alert("Values can't be blank."),t=!1;break}return t}add(e){var t={test_id:this.testIdTarget.value,interpretation:tinymce.activeEditor.getContent()};if(this.isValid(t)){e.currentTarget.innerText="Adding...";var r=JSON.stringify(t),n=this.element.dataset.url;fetch(n,{method:"POST",body:r,headers:{"Content-Type":"application/json"}}).then(s=>this.postAddResponse(s))}}postAddResponse(e){e.status==200?e.text().then(t=>{document.getElementById("interpreation-table-body").innerHTML=t+document.getElementById("interpreation-table-body").innerHTML,document.getElementById("ls-popup-close-btn").click()}):alert("Failed to add.")}update(e){e.currentTarget.innerText="Saving...";var t=JSON.stringify({interpretation:tinymce.activeEditor.getContent()}),r=this.element.dataset.url;fetch(r,{method:"PATCH",body:t,headers:{"Content-Type":"application/json"}}).then(n=>this.postResponse(n))}postResponse(e){e.status==200?e.json().then(t=>{document.getElementById("test_interpreation_text_"+t.id).innerHTML=t.interpretation,document.getElementById("ls-popup-close-btn").click()}):alert("Failed to save.")}};var Br={};o(Br,{default:()=>Ir});var Ir=class extends i{static targets=["activeCount","inactiveCount"];deactivate(e){if(confirm("Are you sure?")){e.currentTarget.innerText="Deactivating...";var t=e.currentTarget.closest("tr"),r=e.currentTarget.dataset.path;fetch(r,{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(n=>this.postDeactivationResponse(n,t))}}postDeactivationResponse(e,t){e.status==200?(this.incrementInactiveCount(),this.decrementActiveCount(),t.remove()):alert("Failed to deactivate. Please ensure you have setup permission.")}activate(e){if(confirm("Are you sure?")){e.currentTarget.innerText="Activating...";var t=e.currentTarget.closest("tr"),r=e.currentTarget.dataset.path;fetch(r,{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(n=>this.postActivationResponse(n,t))}}postActivationResponse(e,t){e.status==200?(this.incrementActiveCount(),this.decrementInctiveCount(),t.remove()):alert("Failed to activate.  Please ensure you have setup permission.")}incrementActiveCount(){this.activeCountTarget.innerText=parseInt(this.activeCountTarget.innerText)+1}decrementInctiveCount(){this.inactiveCountTarget.innerText=parseInt(this.inactiveCountTarget.innerText)-1}incrementInactiveCount(){this.inactiveCountTarget.innerText=parseInt(this.inactiveCountTarget.innerText)+1}decrementActiveCount(){this.activeCountTarget.innerText=parseInt(this.activeCountTarget.innerText)-1}};var Er={};o(Er,{default:()=>Ar});var Ar=class extends i{static targets=[];showForm(e){let t=e.currentTarget.dataset.testResultId;document.getElementById("add_remarks_btn_"+t).classList.add("hidden"),document.getElementById("remarks_form_"+t).classList.remove("hidden")}remove(e){var t=confirm("Are you sure?");if(t==!0){let r=e.currentTarget.dataset.testResultId;document.getElementById("remarks_value_"+r).value="",document.getElementById("add_remarks_btn_"+r).classList.remove("hidden"),document.getElementById("remarks_form_"+r).classList.add("hidden")}}};var Mr={};o(Mr,{default:()=>Sr});var Sr=class extends i{static targets=["loadTemplateLink"];loadTemplate(){var e=confirm("Are you sure you want to use this template?");if(e==!0){var t=this.loadTemplateLinkTarget.dataset.loadTemplateUrl,r=this.loadTemplateLinkTarget.dataset.testFieldId;$.get(t,function(n){var s="textarea.lab-test-field-id-"+r,a=$(s).first().attr("id");tinymce.get(a).setContent(n);var d=tinymce.get(a).iframeElement;d.contentWindow.scrollTo(0,0)})}}};var Pr={};o(Pr,{default:()=>kr});var kr=class extends i{static targets=["alertMsg"];initialize(){this.validInput=null}validate(e){let t=e.currentTarget;(t.dataset.inputType=="decimal"||t.classList.contains("numeric-test-result"))&&this.validateInputCharacters(t.value,t)}reformat(e){let t=e.currentTarget;if((t.dataset.inputType=="decimal"||t.classList.contains("numeric-test-result"))&&(this.validateFormat(e),this.validInput==!0)){let s=e.currentTarget,a=s.value.replaceAll(",","");this.wayOutOfBoundaryAlert(s),s.value=p(a),s.setSelectionRange(s.value.length,s.value.length)}}validateInputCharacters(e,t){if(/^[0-9<>.,]*$/.test(e))this.validInput=!0,this.alertMsgTarget.innerHTML="",t.classList.remove("error");else{this.validInput=!1;var n="Invalid character found. Kindly double check the result before reporting.";this.alertMsgTarget.innerHTML=this.alertHtml(n),t.classList.add("error")}}validateFormat(e){let t=e.currentTarget,r=t.value,n=r.replaceAll(",","");if(this.isValidFloat(n)&&this.hasComma(r))if(this.isValidCommaInput(r))this.validInput=!0,this.alertMsgTarget.innerHTML="",t.classList.remove("error");else{this.validInput=!1;var s="Invalid formatting found. Kindly double check the result before reporting.";this.alertMsgTarget.innerHTML=this.alertHtml(s),t.classList.add("error")}}hasComma(e){return e.includes(",")}isValidCommaInput(e){let t=e.replaceAll(",","");return e===p(t)}isValidFloat(e){return!isNaN(e)&&parseFloat(e).toString()===e.trim()}wayOutOfBoundaryAlert(e){let t=parseFloat(e.value.replaceAll(",","")),r=parseFloat(e.dataset.lowerValue),n=parseFloat(e.dataset.upperValue),s=5;if(t>n*s){var a=`${t} is ${Math.round(t/n)} times greater than ${n}. Kindly double check the result before reporting.`;this.alertMsgTarget.innerHTML=this.alertHtml(a),e.classList.add("error")}else if(t<r/s){var a=`${t} is ${Math.round(r/t)} times lesser than ${r}. Kindly double check the result before reporting.`;this.alertMsgTarget.innerHTML=this.alertHtml(a),e.classList.add("error")}else this.alertMsgTarget.innerHTML="",e.classList.remove("error")}alertHtml(e){return`<div class="inline-flex items-start text-red-500 mt-1 error-msg">
      <svg class="h-6 w-6 mr-1 text-red-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
      </svg>

      <div class="text-xs font-semibold">
        ${e}
      </div>
    </div>`}};var Nr={};o(Nr,{default:()=>jr});var jr=class extends i{connect(){tinymce.init({selector:"textarea.tinymce_textarea",block_formats:"Paragraph=p;Header 3=h3;Header 4=h4",plugins:"table lists paste autoresize",autoresize_bottom_margin:50,max_height:600,menubar:!1,fontsize_formats:"8pt 10pt 12pt 14pt 16pt 18pt 24pt",toolbar:"removeformat | formatselect fontsizeselect | undo redo | bold | table | alignleft aligncenter alignright alignjustify | bullist numlist",browser_spellcheck:!0})}};var Rr={};o(Rr,{default:()=>Dr});var Dr=class extends i{static targets=["reportsContainer","reportsOuterContainer","date","dateHeading","reportsTable","loadedCount","totalCount","loadMoreBtn","loadMoreBtnName"];static values={status:{type:String},sort_by:{type:String},date:{type:String},page:{type:Number},per:{type:Number}};initialize(){this.status="neww",this.sort_by="oldest_first",this.page=1,this.per=50,this.date=moment().format("DD/MM/YYYY"),this.dateTarget.value=this.date,this.updateDateHeading()}connect(){this.loadNewReports()}reorder(e){this.sort_by=e.target.value,this.loadReports()}previousDay(){let e=this.dateTarget.value,t=moment(e,"DD/MM/YYYY").subtract(1,"days");this.isFreePlanRestricted(t)?alert("Not included in free plan"):(this.date=t.format("DD/MM/YYYY"),this.dateTarget.value=this.date,this.updateDateHeading(),this.loadReports())}nextDay(){var e=moment(this.dateTarget.value,"DD/MM/YYYY").add(1,"days"),t=moment();t>e?(this.date=e.format("DD/MM/YYYY"),this.dateTarget.value=this.date,this.updateDateHeading(),this.loadReports()):alert("Cannot select a future date.")}reloadOnDateChange(){let e=this.dateTarget.value,t=moment(e,"DD/MM/YYYY");this.isFreePlanRestricted(t)?(this.dateTarget.value=this.date,alert("Not included in free plan")):(this.date=e,this.updateDateHeading(),this.loadReports())}freePlanDataAccessDaysLimit(){return parseInt(document.getElementById("free_plan_data_access_days_limit").value)}isFreePlanRestricted(e){return this.isFreePlanActive()&&this.outsideFreePlanPremittedDuration(e)}isFreePlanActive(){return document.getElementById("is_free_plan_active").value=="true"}outsideFreePlanPremittedDuration(e){return moment().subtract(this.freePlanDataAccessDaysLimit(),"days")>=e}loadAllReports(){this.status="",this.loadReports()}loadNewReports(){this.status="neww",this.loadReports()}loadInProgressReports(){this.status="in_progress",this.loadReports()}loadFinalReports(){this.status="final",this.loadReports()}loadSignedOffReports(){this.status="signed_off",this.loadReports()}setLoader(){this.reportsContainerTarget.innerHTML=`<div class="flex items-center justify-center" style="min-height:350px;">
                                               <div class="p-12 max-w-md">
                                                 <div class="flex items-center justify-center mb-3">
                                                   <svg class="h-6 w-6 text-blue-600 spinner-svg" viewBox="0 0 24 24">
                                                     <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
                                                       <circle cx="11" cy="11" r="11"></circle>
                                                       <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
                                                     </g>
                                                   </svg>
                                                 </div>
                                               <div class="text-sm text-gray-700 mb-3 font-medium">
                                                Loading...
                                               </div>
                                              </div>
                                            </div>`}updateDateHeading(){moment().format("DD/MM/YYYY")===this.date?this.dateHeadingTarget.innerHTML="today":this.dateHeadingTarget.innerHTML=moment(this.dateTarget.value,"DD/MM/YYYY").format("DD MMM YYYY")}loadUrl(){var e=document.getElementById("lab_identifier").value,t="/"+e+"/lab_reports/by_date_status?status="+this.status+"&on_date="+this.date+"&sort_by="+this.sort_by+"&page="+this.page+"&per="+this.per;return t}loadReports(){this.hasReportsContainerTarget&&this.setLoader(),this.page=1,fetch(this.loadUrl()).then(e=>e.text()).then(e=>this.reportsOuterContainerTarget.innerHTML=e)}loadMoreReports(){this.page=this.page+1;var e=this.loadUrl()+"&load_more=true";this.loadMoreBtnNameTarget.innerHTML=this.spinner()+"Loading...",this.loadMoreBtnTarget.disabled=!0,fetch(e).then(t=>t.text()).then(t=>this.processLoadMoreReportsResponse(t))}processLoadMoreReportsResponse(e){this.reportsTableTarget.innerHTML=this.reportsTableTarget.innerHTML+e;var t=this.reportsTableTarget.getElementsByTagName("tbody").length,r=parseInt(this.totalCountTarget.innerHTML);this.loadedCountTarget.innerHTML=t,this.loadMoreBtnNameTarget.innerText="Load more",t>=r?(this.loadMoreBtnTarget.disabled=!0,this.loadMoreBtnTarget.style.background="gray"):this.loadMoreBtnTarget.disabled=!1,this.scrollToBottom()}scrollToBottom(){document.getElementsByTagName("html")[0].style.scrollBehavior="smooth",window.scrollTo(0,document.body.scrollHeight)}spinner(){return`
      <svg class="h-3 w-3 mr-1 text-white spinner-svg" viewBox="0 0 24 24">
        <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
          <circle cx="11" cy="11" r="11"></circle>
          <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
        </g>
      </svg>
    `}};var Fr={};o(Fr,{default:()=>Or});var Or=class extends i{static targets=["new_case","dashboard","cases","lab_reports","radiology","business","setup"];connect(){var e=document.getElementById("topbar_hightlight");if(e!==null){var t=this.targets.find(e.value);t.classList.add("active")}}};var Vr={};o(Vr,{default:()=>Hr});var Hr=class extends i{static targets=[];processRequest(e){this.insertSpinner(e.target),this.request()}request(){let e=this.element.dataset.requestUrl;fetch(e,{method:"post",headers:{"Content-Type":"application/json"}}).then(t=>t.text()).then(t=>this.element.innerHTML=t)}insertSpinner(e){var t=`<svg class="h-6 w-6 mr-2 spinner-svg" viewBox="0 0 24 24">
                          <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
                            <circle cx="11" cy="11" r="11"></circle>
                            <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
                          </g>
                        </svg>`;e.innerHTML=e.innerHTML+"&nbsp;"+t}};var $r={};o($r,{default:()=>Ur});var Ur=class extends i{static targets=["uploadingGif","inputFileContainer","logoContainer","logoImage"];getUploadUrlAndUpload(e){this.uploadingGifTarget.classList.remove("hidden"),this.inputFileContainerTarget.classList.add("hidden"),this.logoContainerTarget.classList.add("hidden"),this.logoContainerTarget.classList.add("no-print");var t=e.srcElement,r="/cf_upload_url";fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(n=>n.json()).then(n=>{this.uploadImage(n.upload_url,t)})}uploadImage(e,t){var r=new FormData,n=t.files[0];r.append("file",n),fetch(e,{method:"POST",body:r}).then(s=>s.json()).then(s=>{this.processResponse(s,t)})}processResponse(e,t){var r=e.result.id;this.logoImageTarget.src=e.result.variants[0],this.saveAndDisplayLogo(r),t.value=""}saveAndDisplayLogo(e){var t=this.element.dataset.logoUpdateUrl,r=JSON.stringify({logo_cf_image_id:e});fetch(t,{method:"PATCH",body:r,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(n=>this.processLogoResponse(n))}processLogoResponse(e){e.status==200&&(this.uploadingGifTarget.classList.add("hidden"),this.logoContainerTarget.classList.remove("hidden"),this.logoContainerTarget.classList.remove("no-print"))}deleteLogo(){if(confirm("Are you sure?")){var e=this.element.dataset.logoDeleteUrl;fetch(e,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(t=>this.deleteLogoResponse(t))}}deleteLogoResponse(e){e.status==200&&(this.logoImageTarget.src="",this.logoContainerTarget.classList.add("hidden"),this.logoContainerTarget.classList.add("no-print"),this.inputFileContainerTarget.classList.remove("hidden"))}};var qr={};o(qr,{default:()=>zr});var zr=class extends i{static targets=["nameEditBtn","emailEditBtn","mobileNumEditBtn","nameInput","emailInput","mobileNumInput","nameEditAction","emailEditAction","mobileNumEditAction"];editName(){this.disableAllInputFields(),this.makeNameFieldEditable()}editEmail(){this.disableAllInputFields(),this.makeEmailFieldEditable()}editMobileNumber(){this.disableAllInputFields(),this.makeMobileNumFieldEditable()}cancelEdit(){this.disableAllInputFields(),this.showAllEditBtn(),this.hideAllEditActions()}disableAllInputFields(){this.showAllEditBtn(),this.disableAllInputBox(),this.hideAllEditActions()}showAllEditBtn(){this.nameEditBtnTarget.classList.remove("hidden"),this.emailEditBtnTarget.classList.remove("hidden"),this.mobileNumEditBtnTarget.classList.remove("hidden")}hideAllEditActions(){this.nameEditActionTarget.classList.add("hidden"),this.emailEditActionTarget.classList.add("hidden"),this.mobileNumEditActionTarget.classList.add("hidden")}disableAllInputBox(){this.nameInputTarget.disabled=!0,this.emailInputTarget.disabled=!0,this.mobileNumInputTarget.disabled=!0,this.restoreInputValue(this.nameInputTarget),this.restoreInputValue(this.emailInputTarget),this.restoreInputValue(this.mobileNumInputTarget)}makeNameFieldEditable(){this.nameEditBtnTarget.classList.add("hidden"),this.nameInputTarget.disabled=!1,this.nameEditActionTarget.classList.remove("hidden")}makeEmailFieldEditable(){this.emailEditBtnTarget.classList.add("hidden"),this.emailInputTarget.disabled=!1,this.emailEditActionTarget.classList.remove("hidden")}makeMobileNumFieldEditable(){this.mobileNumEditBtnTarget.classList.add("hidden"),this.mobileNumInputTarget.disabled=!1,this.mobileNumEditActionTarget.classList.remove("hidden")}restoreInputValue(e){e.value=e.dataset.value}};var Yr={};o(Yr,{default:()=>Wr});var Wr=class extends i{static targets=[];shrink(){$(".usg-report td").each(function(){var e=parseInt($(this).css("padding-top"))-1;e>=0&&$(this).css("padding-top",e+"px");var t=parseInt($(this).css("padding-top"))-1;t>=0&&$(this).css("padding-bottom",t+"px")})}expand(){$(".usg-report td").each(function(){var e=parseInt($(this).css("padding-top"));$(this).css("padding-top",e+1+"px");var t=parseInt($(this).css("padding-top"));$(this).css("padding-bottom",t+1+"px")})}};var Kr={};o(Kr,{default:()=>Jr});var Jr=class extends i{static targets=[];firstLetterCapitalize(e){e.currentTarget.value.length==1&&(e.currentTarget.value=e.currentTarget.value.toUpperCase())}};var Qr={};o(Qr,{default:()=>Gr});var Gr=class extends i{validate(e){let t=e.target.files[0];if(t)if(!t.type.startsWith("image/"))alert("File type not supported. Kindly upload image file."),e.target.value="";else{let r=new Image,n=new FileReader,s=1.4;n.onload=function(a){r.onload=function(){let d=r.width,u=r.height/d;var l=document.getElementById("image-ratio");l.innerHTML=` <p> Aspect ratio of uploaded file: ${u.toFixed(3)} </p>
                                    <p> Expected aspect ratio: 1.414 </p>`,u.toFixed(1)!=s?(e.target.value="",alert("Can't upload invalid letterhead, ensure lettehead is of A4 size aspect ratio. Image height / width should be 1.41"),l.classList.add("text-red"),l.classList.remove("text-green")):(l.classList.remove("text-red"),l.classList.add("text-green"))},r.src=a.target.result},n.readAsDataURL(t)}}};var Zr={};o(Zr,{default:()=>Xr});var Xr=class extends i{static targets=["spinnerContainer"];updateVersion(e){this.insertSpinner();var t=this.element.dataset.updateUrl,r=JSON.stringify({version:e.currentTarget.value});fetch(t,{method:"PATCH",body:r,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(n=>this.processResponse(n))}processResponse(e){e.json().then(t=>{window.location.href=t.redirect_to})}insertSpinner(){var e=`<svg class="h-4 w-4 mr-2 text-blue-500 spinner-svg" viewBox="0 0 24 24">
          <g fill="none" fill-rule="nonzero" transform="translate(1 1)">
            <circle cx="11" cy="11" r="11"></circle>
            <path d="M10.998 22a.846.846 0 0 1 0-1.692 9.308 9.308 0 0 0 0-18.616 9.286 9.286 0 0 0-7.205 3.416.846.846 0 1 1-1.31-1.072A10.978 10.978 0 0 1 10.998 0c6.075 0 11 4.925 11 11s-4.925 11-11 11z" fill="currentColor"></path>
          </g>
      </svg>`;this.spinnerContainerTarget.innerHTML=e}};var tn={};o(tn,{default:()=>en});var en=class extends i{static targets=["hideable"];toggle(){this.hideableTarget.classList.toggle("hidden")}};var nn={};o(nn,{default:()=>rn});var rn=class extends i{loadVideos(){fetch("/help_videos").then(e=>e.text()).then(e=>document.getElementById("help-videos").innerHTML=e)}};var an={};o(an,{default:()=>sn});var sn=class extends i{static targets=["spinner","verifyButton","validateDnsButton"];labIdentifier(){return document.getElementById("lab_identifier").value}verify(){this.spinnerTarget.classList.remove("hidden"),this.checkSite()}validateDns(){this.spinnerTarget.classList.remove("hidden");var e="/"+this.labIdentifier()+"/ecommerce/validate_dns_record";fetch(e).then(t=>t.json()).then(t=>this.processValidateDnsResponse(t))}checkSite(){var e="/"+this.labIdentifier()+"/ecommerce/verify_website_live";fetch(e).then(t=>t.json()).then(t=>this.processResponse(t))}processResponse(e){e.live===!0?window.location="/"+this.labIdentifier()+"/ecommerce/setup_success":alert("Site is not live, please wait minimum 5 mins. and try again. Contact support for help."),this.spinnerTarget.classList.add("hidden")}processValidateDnsResponse(e){e.valid===!0?(alert("DNS record updated successfully."),this.verifyButtonTarget.classList.remove("hidden"),this.validateDnsButtonTarget.classList.add("hidden")):alert("DNS record not updated, please try again later or contact support."),this.spinnerTarget.classList.add("hidden")}};var ln={};o(ln,{default:()=>on});var on=class extends i{static targets=["imageId","previewImage","previewContainer","uploadingGif","inputFileContainer","form"];labIdentifier(){return document.getElementById("lab_identifier").value}delete(e){e.preventDefault(),this.previewContainerTarget.classList.add("hidden"),this.inputFileContainerTarget.classList.remove("hidden"),this.imageIdTarget.value=null,this.submitForm()}getUploadUrlAndUpload(e){this.uploadingGifTarget.classList.remove("hidden"),this.inputFileContainerTarget.classList.add("hidden"),this.previewContainerTarget.classList.add("hidden");var t=e.srcElement,r="/cf_upload_url";fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(n=>n.json()).then(n=>{this.uploadImage(n.upload_url,t)})}uploadImage(e,t){var r=new FormData,n=t.files[0];r.append("file",n),fetch(e,{method:"POST",body:r}).then(s=>s.json()).then(s=>{this.processResponse(s,t)})}processResponse(e,t){this.uploadingGifTarget.classList.add("hidden"),this.previewContainerTarget.classList.remove("hidden"),this.imageIdTarget.value=e.result.id,this.previewImageTarget.src=e.result.variants[0],t.value="",this.submitForm()}submitForm(){this.formTarget.submit()}};var ii=[{name:"controllers--access-permissions",module:I,filename:"./controllers/access_permissions_controller.js"},{name:"controllers--age-calculator",module:A,filename:"./controllers/age_calculator_controller.js"},{name:"controllers--apply-select2",module:S,filename:"./controllers/apply_select2_controller.js"},{name:"controllers--ask-review",module:k,filename:"./controllers/ask_review_controller.js"},{name:"controllers--autofill-onclick",module:j,filename:"./controllers/autofill_onclick_controller.js"},{name:"controllers--bill-barcode",module:D,filename:"./controllers/bill_barcode_controller.js"},{name:"controllers--bill-page-introjs",module:O,filename:"./controllers/bill_page_introjs_controller.js"},{name:"controllers--bill-pdf",module:H,filename:"./controllers/bill_pdf_controller.js"},{name:"controllers--billing-permissions",module:U,filename:"./controllers/billing_permissions_controller.js"},{name:"controllers--business-report-permissions",module:q,filename:"./controllers/business_report_permissions_controller.js"},{name:"controllers--cases",module:Y,filename:"./controllers/cases_controller.js"},{name:"controllers--category-content",module:K,filename:"./controllers/category_content_controller.js"},{name:"controllers--char-count",module:Q,filename:"./controllers/char_count_controller.js"},{name:"controllers--checked-validation",module:Z,filename:"./controllers/checked_validation_controller.js"},{name:"controllers--clipboard",module:te,filename:"./controllers/clipboard_controller.js"},{name:"controllers--configure-lab-report",module:ne,filename:"./controllers/configure_lab_report_controller.js"},{name:"controllers--dashboard-support-ticket",module:se,filename:"./controllers/dashboard_support_ticket_controller.js"},{name:"controllers--discount-reason",module:oe,filename:"./controllers/discount_reason_controller.js"},{name:"controllers--discount-type",module:de,filename:"./controllers/discount_type_controller.js"},{name:"controllers--email-validation",module:ue,filename:"./controllers/email_validation_controller.js"},{name:"controllers--expiring-deal",module:me,filename:"./controllers/expiring_deal_controller.js"},{name:"controllers--form-submit",module:fe,filename:"./controllers/form_submit_controller.js"},{name:"controllers--free-plan-limit-exceed-modal",module:ve,filename:"./controllers/free_plan_limit_exceed_modal_controller.js"},{name:"controllers--free-plan-request",module:be,filename:"./controllers/free_plan_request_controller.js"},{name:"controllers--go-live-checklist",module:xe,filename:"./controllers/go_live_checklist_controller.js"},{name:"controllers--highlight-active",module:Ce,filename:"./controllers/highlight_active_controller.js"},{name:"controllers--idle-popup",module:we,filename:"./controllers/idle_popup_controller.js"},{name:"controllers--lab-ratelist-entry",module:Be,filename:"./controllers/lab_ratelist_entry_controller.js"},{name:"controllers--lab-report-permissions",module:Ee,filename:"./controllers/lab_report_permissions_controller.js"},{name:"controllers--lab-report-test-interpretation",module:Me,filename:"./controllers/lab_report_test_interpretation_controller.js"},{name:"controllers--left-sidebar-highlight",module:Pe,filename:"./controllers/left_sidebar_highlight_controller.js"},{name:"controllers--length-validation",module:Ne,filename:"./controllers/length_validation_controller.js"},{name:"controllers--loadmore",module:Re,filename:"./controllers/loadmore_controller.js"},{name:"controllers--ls-popup",module:Fe,filename:"./controllers/ls_popup_controller.js"},{name:"controllers--ls-tabs",module:Ve,filename:"./controllers/ls_tabs_controller.js"},{name:"controllers--machine-data",module:$e,filename:"./controllers/machine_data_controller.js"},{name:"controllers--modal",module:qe,filename:"./controllers/modal_controller.js"},{name:"controllers--new-case-page-introjs",module:Ye,filename:"./controllers/new_case_page_introjs_controller.js"},{name:"controllers--normal-value-display",module:Ke,filename:"./controllers/normal_value_display_controller.js"},{name:"controllers--normal-value-form",module:Qe,filename:"./controllers/normal_value_form_controller.js"},{name:"controllers--notes-remarks-advice",module:Ze,filename:"./controllers/notes_remarks_advice_controller.js"},{name:"controllers--notifications",module:tt,filename:"./controllers/notifications_controller.js"},{name:"controllers--one-time-alert",module:nt,filename:"./controllers/one_time_alert_controller.js"},{name:"controllers--optional-values",module:st,filename:"./controllers/optional_values_controller.js"},{name:"controllers--page-refresh-timer",module:ot,filename:"./controllers/page_refresh_timer_controller.js"},{name:"controllers--panel-content",module:dt,filename:"./controllers/panel_content_controller.js"},{name:"controllers--panel-interpretation",module:ut,filename:"./controllers/panel_interpretation_controller.js"},{name:"controllers--panel-interpretation-form",module:mt,filename:"./controllers/panel_interpretation_form_controller.js"},{name:"controllers--patient-details",module:ft,filename:"./controllers/patient_details_controller.js"},{name:"controllers--patient-form",module:vt,filename:"./controllers/patient_form_controller.js"},{name:"controllers--patient-history",module:bt,filename:"./controllers/patient_history_controller.js"},{name:"controllers--payment-history",module:xt,filename:"./controllers/payment_history_controller.js"},{name:"controllers--payment-mode-split",module:Ct,filename:"./controllers/payment_mode_split_controller.js"},{name:"controllers--permissions",module:wt,filename:"./controllers/permissions_controller.js"},{name:"controllers--poll-url",module:Bt,filename:"./controllers/poll_url_controller.js"},{name:"controllers--possible-values",module:Et,filename:"./controllers/possible_values_controller.js"},{name:"controllers--possible-values-create",module:Mt,filename:"./controllers/possible_values_create_controller.js"},{name:"controllers--possible-values-delete",module:Pt,filename:"./controllers/possible_values_delete_controller.js"},{name:"controllers--possible-values-update",module:Nt,filename:"./controllers/possible_values_update_controller.js"},{name:"controllers--pricing",module:Rt,filename:"./controllers/pricing_controller.js"},{name:"controllers--print-ready-options",module:Ft,filename:"./controllers/print_ready_options_controller.js"},{name:"controllers--print-status",module:Vt,filename:"./controllers/print_status_controller.js"},{name:"controllers--reactions",module:$t,filename:"./controllers/reactions_controller.js"},{name:"controllers--referrers-ratelist-entries",module:qt,filename:"./controllers/referrers_ratelist_entries_controller.js"},{name:"controllers--remove-file",module:Yt,filename:"./controllers/remove_file_controller.js"},{name:"controllers--render-qr-code",module:Kt,filename:"./controllers/render_qr_code_controller.js"},{name:"controllers--report-sidebar",module:Qt,filename:"./controllers/report_sidebar_controller.js"},{name:"controllers--required-validation",module:Zt,filename:"./controllers/required_validation_controller.js"},{name:"controllers--resend-otp",module:tr,filename:"./controllers/resend_otp_controller.js"},{name:"controllers--sample-collector",module:nr,filename:"./controllers/sample_collector_controller.js"},{name:"controllers--scroll-to-top",module:sr,filename:"./controllers/scroll_to_top_controller.js"},{name:"controllers--search-container",module:or,filename:"./controllers/search_container_controller.js"},{name:"controllers--search",module:dr,filename:"./controllers/search_controller.js"},{name:"controllers--search-filters",module:ur,filename:"./controllers/search_filters_controller.js"},{name:"controllers--search-in-list",module:mr,filename:"./controllers/search_in_list_controller.js"},{name:"controllers--search-in-page",module:fr,filename:"./controllers/search_in_page_controller.js"},{name:"controllers--search-load-reports",module:vr,filename:"./controllers/search_load_reports_controller.js"},{name:"controllers--send-reports",module:br,filename:"./controllers/send_reports_controller.js"},{name:"controllers--setup-highlight",module:xr,filename:"./controllers/setup_highlight_controller.js"},{name:"controllers--table-row-expand",module:Cr,filename:"./controllers/table_row_expand_controller.js"},{name:"controllers--test-interpretation-form",module:wr,filename:"./controllers/test_interpretation_form_controller.js"},{name:"controllers--test-packages",module:Br,filename:"./controllers/test_packages_controller.js"},{name:"controllers--test-result-remarks",module:Er,filename:"./controllers/test_result_remarks_controller.js"},{name:"controllers--test-result-templates",module:Mr,filename:"./controllers/test_result_templates_controller.js"},{name:"controllers--test-result-value",module:Pr,filename:"./controllers/test_result_value_controller.js"},{name:"controllers--tinymce",module:Nr,filename:"./controllers/tinymce_controller.js"},{name:"controllers--todays-lab-reports",module:Rr,filename:"./controllers/todays_lab_reports_controller.js"},{name:"controllers--topbar-highlight",module:Fr,filename:"./controllers/topbar-highlight_controller.js"},{name:"controllers--unlock-trial",module:Vr,filename:"./controllers/unlock_trial_controller.js"},{name:"controllers--upload-bill-logo",module:$r,filename:"./controllers/upload_bill_logo_controller.js"},{name:"controllers--user-profile-update",module:qr,filename:"./controllers/user_profile_update_controller.js"},{name:"controllers--usg-report-padding",module:Yr,filename:"./controllers/usg_report_padding_controller.js"},{name:"controllers--utility",module:Kr,filename:"./controllers/utility_controller.js"},{name:"controllers--validate-letterhead",module:Qr,filename:"./controllers/validate_letterhead_controller.js"},{name:"controllers--version-selector",module:Zr,filename:"./controllers/version_selector_controller.js"},{name:"controllers--visibility",module:tn,filename:"./controllers/visibility_controller.js"},{name:"controllers--watch-video",module:nn,filename:"./controllers/watch_video_controller.js"},{name:"controllers--website-verification",module:an,filename:"./controllers/website_verification_controller.js"},{name:"controllers--websites-upload",module:ln,filename:"./controllers/websites_upload_controller.js"}],Mn=ii;var si=_.start();En(si,Mn,"controllers");})();
